<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Makam 칖stad캼 - Kulak Testi</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0f0f0f;
            --accent: #c5a059;
            --glass: rgba(30, 30, 30, 0.95);
            --correct: #27ae60;
            --wrong: #c0392b;
            --text: #f0f0f0;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        .game-container {
            background: var(--glass);
            width: 90%;
            max-width: 600px;
            padding: 40px;
            border-radius: 20px;
            border: 1px solid rgba(197, 160, 89, 0.3);
            text-align: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
            position: relative;
            transition: height 0.3s;
        }

        h1 { font-family: 'Playfair Display', serif; color: var(--accent); margin-bottom: 10px; }
        h2 { font-family: 'Playfair Display', serif; margin: 10px 0; }

        /* BUTONLAR */
        .btn-main {
            background: var(--accent); color: #000; border: none;
            padding: 15px 40px; font-weight: bold; border-radius: 30px;
            cursor: pointer; transition: 0.3s; margin-top: 20px; font-size: 1.1rem;
            display: inline-block;
        }
        .btn-main:hover { transform: scale(1.05); box-shadow: 0 0 15px var(--accent); }

        /* SES OYNATICI */
        .audio-player-wrapper {
            margin: 20px auto;
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 4px solid var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: 0.3s;
            box-shadow: 0 0 20px rgba(197, 160, 89, 0.2);
        }
        .audio-player-wrapper:hover { transform: scale(1.05); box-shadow: 0 0 30px rgba(197, 160, 89, 0.4); }
        .audio-icon { font-size: 3rem; color: var(--text); }
        
        .playing-animation {
            position: absolute; width: 100%; height: 100%; border-radius: 50%;
            border: 2px solid var(--accent); opacity: 0;
            animation: ripple 1.5s infinite;
        }
        @keyframes ripple {
            0% { transform: scale(1); opacity: 0.8; }
            100% { transform: scale(1.5); opacity: 0; }
        }

        /* SE칂ENEKLER */
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 30px; }
        .option-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px; border-radius: 10px; color: #ccc;
            cursor: pointer; transition: 0.3s; font-size: 1.1rem;
        }
        .option-btn:hover { border-color: var(--accent); color: #fff; background: rgba(197, 160, 89, 0.1); }
        .correct { background: var(--correct) !important; color: white !important; border-color: var(--correct); }
        .wrong { background: var(--wrong) !important; color: white !important; border-color: var(--wrong); }

        /* A뢰MA G칐STERGES캻 */
        .progress-indicator {
            font-size: 0.9rem; color: #888; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px;
        }
        .active-step { color: var(--accent); font-weight: bold; }

        /* G캻ZLEME SINIFLARI */
        .screen { display: none; animation: fadeIn 0.5s; }
        .screen.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    </style>
</head>
<body>

    <div class="game-container">
        
        <div id="start-screen" class="screen active">
            <i class="fas fa-music" style="font-size: 4rem; color: var(--accent); margin-bottom: 20px;"></i>
            <h1>Makam 칖stad캼</h1>
            <p style="color:#ccc; line-height: 1.6; margin-bottom: 30px;">
                Makam bilginize g칲veniyor musunuz?<br>
                Sizi zorlu bir s캼nav bekliyor.
            </p>
            <div style="background: rgba(255,255,255,0.05); padding: 20px; border-radius: 10px; text-align: left; font-size: 0.9rem; color: #aaa; margin-bottom: 30px;">
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin-bottom: 10px;"><i class="fas fa-check" style="color:var(--accent); width:20px;"></i> Toplam <strong>7 Soru</strong></li>
                    <li style="margin-bottom: 10px;"><i class="fas fa-times" style="color:var(--wrong); width:20px;"></i> Yanl캼 cevapta <strong>elenirsiniz</strong>.</li>
                    <li><i class="fas fa-headphones" style="color:#3498db; width:20px;"></i> Kulakl캼kla dinlemeniz 칬nerilir.</li>
                </ul>
            </div>
            <button class="btn-main" onclick="startGame()">BA뢻A</button>
        </div>

        <div id="game-screen" class="screen">
            <div class="progress-indicator">
                Soru <span id="q-current" class="active-step">1</span> / 7
            </div>

            <div class="audio-player-wrapper" onclick="toggleAudio()">
                <div id="ripple-effect"></div>
                <i id="play-icon" class="fas fa-play audio-icon"></i>
            </div>
            
            <div id="status-text" style="min-height: 25px; color:#888; font-style: italic;">Dinlemek i칞in butona bas캼n</div>

            <div class="options-grid" id="options-area">
                </div>
        </div>

        <div id="result-screen" class="screen">
            <div id="result-icon-container" style="margin-bottom: 20px;"></div>
            <h2 id="result-title"></h2>
            <p id="result-msg" style="color:#ccc; margin-bottom: 30px;"></p>
            <div id="final-score-display" style="font-size: 1.2rem; color: var(--accent); margin-bottom: 30px;"></div>
            <button class="btn-main" onclick="location.reload()">TEKRAR DENE</button>
        </div>

        <audio id="game-audio"></audio>
    </div>

    <script>
        // --- SES DOSYALARINIZI BURAYA EKLEY캻N ---
        // Not: Ger칞ek bir deneyim i칞in 'audioSrc' k캼s캼mlar캼na kendi mp3 linklerinizi koymal캼s캼n캼z.
        const allQuestions = [
            { id: 1, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/bayati-oyun.mp3", dogru: "Bayati", secenekler: ["U르k", "H칲seyni", "Bayati", "Rast"] },
            { id: 2, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/bueslik-oyun.mp3", dogru: "Buselik", secenekler: ["Buselik", "Nihavent", "Saba", "H칲zzam"] },
            { id: 3, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/cargah-oyun.mp3", dogru: "칂arg칙h", secenekler: ["칂arg칙h", "H칲zzam", "M칲stear", "Irak"] },
            { id: 4, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/neva-oyun.mp3", dogru: "Neva", secenekler: ["Mahur", "Rast", "Acem를ran", "Neva"] },
            { id: 5, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/muhayyer-oyun.mp3", dogru: "Muhayyer", secenekler: ["Seg칙h", "H칲zzam", "Karc캼르r", "Muhayyer"] },
            { id: 6, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/muhayyer-kurdi-oyun.mp3", dogru: "Muhayyer K칲rdi", secenekler: ["Muhayyer K칲rdi", "Hicazkar", "Nihavent", "Sultaniyeg칙h"] },
            { id: 7, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/huzzam-oyun.mp3", dogru: "H칲zzam", secenekler: ["Hicaz", "U르k", "H칲zzam", "Segah"] },
            { id: 8, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/huseyni-oyun.mp3", dogru: "H칲seyni", secenekler: ["H칲seyni", "Hicaz", "Saba", "Tahir"] },
            { id: 9, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/hicaz-oyun.mp3", dogru: "Hicaz", secenekler: ["Uzzal", "Hicaz", "Suzinak", "Bestenigar"] },
            { id: 10, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/nihavent-oyun.mp3", dogru: "Nihavent", secenekler: ["Nihavent", "Hicaz", "Sulant-캼 Yegah", "Buselik"] },
            { id: 11, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/ussak-oyunn.mp3", dogru: "U르k", secenekler: ["Bayati", "Zirg칲le", "H칲seyni", "U르k"] },
            { id: 12, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/segah-oyun.mp3", dogru: "Seg칙h", secenekler: ["Nikriz", "H칲zzam", "Seg칙h", "K칲rdili Hicazkar"] },
            { id: 13, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/rast-oyun.mp3", dogru: "Rast", secenekler: ["Rast", "H칲seyni", "Saba", "Karc캼르r"] },
            { id: 14, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/kurdili-hicazkar-oyun.mp3", dogru: "K칲rdili Hicazkar", secenekler: ["K칲rdi", "Neveser", "Hicazkar", "K칲rdili Hicazkar"] },
            { id: 15, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/kargigar-oyun.mp3", dogru: "Karc캼르r", secenekler: ["Karc캼르r", "H칲seyni", "Acem A를ran", "B칲z칲rk"] },
            { id: 16, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-makam/saba-oyun.mp3", dogru: "Saba", secenekler: ["U르k", "Hicaz", "Saba", "Canfez칙"] },
            { id: 17, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/bayati1.mp3", dogru: "Bayati", secenekler: ["Rast", "Bayati", "H칲seyni", "U르k"] },
            { id: 18, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/bayati2.mp3", dogru: "Bayati", secenekler: ["U르k", "H칲seyni", "Bayati", "Rast"] },
            { id: 19, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/cargah.mp3", dogru: "칂arg칙h", secenekler: ["칂arg칙h", "Buselik", "M칲stear", "Do Min칬r"] },
            { id: 20, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/cargah1.mp3", dogru: "칂arg칙h", secenekler: ["칂arg칙h", "D칲gah", "M칲stear", "K칲rdi"] },
            { id: 21, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/cargah2.mp3", dogru: "칂arg칙h", secenekler: ["칂arg칙h", "Segah", "Tahir", "Irak"] },
            { id: 22, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicaz.mp3", dogru: "Hicaz", secenekler: ["Hicazkar", "Hicaz", "Suzinak", "Bestenigar"] },
            { id: 23, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicaz1.mp3", dogru: "Hicaz", secenekler: ["K칲rdi", "Tahir", "Suzinak", "Hicaz"] },
            { id: 24, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicaz2.mp3", dogru: "Hicaz", secenekler: ["Uzzal", "Hicaz", "Suzinak", "Bestenigar"] },
            { id: 25, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicaz4.mp3", dogru: "Hicaz", secenekler: ["Hicaz", "Hicazkar", "Suzinak", "Muhayyer k칲rdi"] },
            { id: 26, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicaz5.mp3", dogru: "Hicaz", secenekler: ["Mahur", "Hicaz", "Suzinak", "Bestenigar"] },
            { id: 27, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicazkar.mp3", dogru: "Hicazkar", secenekler: ["Hicaz", "Hicazkar", "K칲rdili Hicazkar", "Bestenigar"] },
            { id: 28, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicazkar1.mp3", dogru: "Hicazkar", secenekler: ["K칲rdili Hicazkar", "Hicaz", "Suzinak", "Hicazkar"] },
            { id: 29, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/hicazkar2.mp3", dogru: "Hicazkar", secenekler: ["Hicazkar", "Hicaz", "Suzinak", "Karc캼르r"] },
            { id: 30, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huseyni1.mp3", dogru: "H칲seyni", secenekler: ["U르k", "Hicaz", "H칲seyni", "Tahir"] },
            { id: 31, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huseyni2.mp3", dogru: "H칲seyni", secenekler: ["H칲seyni", "Acem A를ran", "H칲seyni A를ran", "Muhayyer"] },
            { id: 32, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huseyni3.mp3", dogru: "H칲seyni", secenekler: ["U르k", "H칲seyni", "Saba", "H칲seyni A를ran"] },
            { id: 33, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huseyni4.mp3", dogru: "H칲seyni", secenekler: ["Saba", "Hicaz", "U르k", "H칲seyni"] },
            { id: 34, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huseyni4.mp3", dogru: "H칲seyni", secenekler: ["H칲seyni", "U르k", "Karc캼르r", "H칲seyni A를ran"] },
            { id: 35, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huzzam.mp3", dogru: "H칲zzam", secenekler: ["Ferahfeza", "H칲zzam", "Segah", "Ferahnak"] },
            { id: 36, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huzzam1.mp3", dogru: "H칲zzam", secenekler: ["Segah", "Hisar", "Hicaz", "H칲zzam"] },
            { id: 37, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/huzzam3.mp3", dogru: "H칲zzam", secenekler: ["Segah-캼 H칲zzam", "H칲zzam", "Segah", "Mahur"] },
            { id: 38, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/kurdilihicazkar.mp3", dogru: "K칲rdili Hicazkar", secenekler: ["K칲rdi", "K칲rdili Hicazkar", "Hicazkar", "Muhayyer K칲rdi"] },
            { id: 39, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/kurdilihicazkar1.mp3", dogru: "K칲rdili Hicazkar", secenekler: ["K칲rdili Hicazkar", "Muhayyer K칲rdi", "Hicazkar", "K칲rdi"] },
            { id: 40, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/kurdilihicazkar3.mp3", dogru: "K칲rdili Hicazkar", secenekler: ["K칲rdi", "Hicaz", "Hicazkar", "K칲rdili Hicazkar"] },
            { id: 41, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/kurdilihicazkar4.mp3", dogru: "K칲rdili Hicazkar", secenekler: ["K칲rdi", "Muhayyer K칲rdi", "Hicazkar", "K칲rdili Hicazkar"] },
            { id: 42, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/muhayyerkurdi.mp3", dogru: "Muhayyer K칲rdi", secenekler: ["Muhayyer K칲rdi", "Hicazkar", "Nihavent", "K칲rdili Hicazkar"] },
            { id: 43, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/nihavent.mp3", dogru: "Nihavent", secenekler: ["Nihavent", "Hicaz", "Muhayyer", "Buselik"] },
            { id: 44, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/nihavent2.mp3", dogru: "Nihavent", secenekler: ["Nihavent", "K칲rdi", "Sulant-캼 Yegah", "Buselik"] },
            { id: 45, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/nihavent3.mp3", dogru: "Nihavent", secenekler: ["칂argah", "Buselik", "Hicavent", "Nihavent"] },
            { id: 46, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/nihavent4.mp3", dogru: "Nihavent", secenekler: ["Nikriz", "Nihavent", "Buselik", "D칲gah"] },
            { id: 47, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/nihavent5.mp3", dogru: "Nihavent", secenekler: ["Neva", "Hicaz", "Nihavent", "Buselik"] },
            { id: 48, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/nihavent6.mp3", dogru: "Nihavent", secenekler: ["B칲z칲rk", "Buselik", "Nihavent", "Acem"] },
            { id: 49, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/rast.mp3", dogru: "Rast", secenekler: ["Rast", "H칲seyni", "Saba", "Rastgele"] },
            { id: 50, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/rast1.mp3", dogru: "Rast", secenekler: ["Saba", "H칲seyni", "Rast", "Rastiye"] },
            { id: 51, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/rast2.mp3", dogru: "Rast", secenekler: ["H칲seyni", "Rast", "Saba", "Karc캼르r"] },
            { id: 52, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/rast3.mp3", dogru: "Rast", secenekler: ["캻sfahan", "H칲seyni", "Rast", "U르k"] },
            { id: 53, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/rast4.mp3", dogru: "Rast", secenekler: ["Rast", "G칲lizar", "Ni르bur", "H칲seyni"] },
            { id: 54, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/rast6.mp3", dogru: "Rast", secenekler: ["Rast", "H칲seyni", "B칲z칲rk", "U르k"] },
            { id: 55, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/saba.mp3", dogru: "Saba", secenekler: ["U르k", "Hicaz", "Saba", "Canfez칙"] },
            { id: 56, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/saba2.mp3", dogru: "Saba", secenekler: ["Saba", "Hicaz", "Evc", "Huzi"] },
            { id: 57, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/saba3.mp3", dogru: "Saba", secenekler: ["Ferahn칲ma", "Saba", "M칲stear", "Suzidil"] },
            { id: 58, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/ussak1.mp3", dogru: "U르k", secenekler: ["Bayati", "Zirg칲le", "H칲seyni", "U르k"] },
            { id: 59, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/ussak2.mp3", dogru: "U르k", secenekler: ["H칲seyni", "U르k", "Bayati", "H칲seyni A를ran"] },
            { id: 60, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/ussak3.mp3", dogru: "U르k", secenekler: ["Bayati", "Bayati 룔raz", "Acem", "U르k"] },
            { id: 61, audioSrc: "https://raw.githubusercontent.com/brkslntss-png/baglamagram/main/oyun-muzigi-22/ussak4.mp3", dogru: "U르k", secenekler: ["U르k", "Hicazkar", "H칲seyni", "Bayati"] },
            
            
            
            
            
            
            // Havuzda daha fazla soru olabilir, ama oyun 7 tanesini se칞ecek.
        ];

        let gameQuestions = [];
        let currentQIndex = 0;
        const totalQuestions = 7;
        
        const audioEl = document.getElementById('game-audio');
        const playIcon = document.getElementById('play-icon');
        const ripple = document.getElementById('ripple-effect');
        const statusText = document.getElementById('status-text');

        function switchScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

       function startGame() {
            // 1. Taray캼c캼 haf캼zas캼ndan daha 칬nce sorulmu 르rk캼lar캼n ID'lerini getir
            // "playedSongsIds" ad캼nda bir kutuda sakl캼yoruz.
            let playedIDs = JSON.parse(localStorage.getItem('playedSongsIds')) || [];

            // 2. T칲m 르rk캼lardan oynanm캼륿ar캼 칞캼kar (Geriye kalan temiz havuz)
            let availableQuestions = allQuestions.filter(q => !playedIDs.includes(q.id));

            console.log("Kalan 료rk캼 Say캼s캼:", availableQuestions.length); // Konsoldan takip edebilirsiniz

            // 3. E른r kalan 르rk캼 say캼s캼 7'den azsa (Yani yeni bir oyun kuracak kadar 르rk캼 kalmad캼ysa)
            if (availableQuestions.length < 7) {
                alert("Tebrikler! Repertuvar캼n tamam캼n캼 (61 르rk캼) bitirdiniz. Liste s캼f캼rlan캼yor ve ba릆an ba륿캼yor!");
                playedIDs = []; // Haf캼zay캼 s캼f캼rla
                localStorage.removeItem('playedSongsIds'); // Taray캼c캼dan sil
                availableQuestions = [...allQuestions]; // Hepsini geri y칲kle
            }

            // 4. Kalanlar aras캼ndan rastgele 7 tane se칞
            gameQuestions = availableQuestions.sort(() => 0.5 - Math.random()).slice(0, 7);
            
            // 5. Bu se칞ilen 7 르rk캼y캼 "oynanm캼" olarak haf캼zaya kaydet
            // (B칬ylece sayfa yenilense veya 'Tekrar Dene' butonuna bas캼lsa bile bunlar elenmi olur)
            const newIDs = gameQuestions.map(q => q.id);
            // Eski listeye yenileri ekle
            playedIDs = [...playedIDs, ...newIDs];
            // G칲ncel listeyi kaydet
            localStorage.setItem('playedSongsIds', JSON.stringify(playedIDs));

            // Oyunu ba륿at
            currentQIndex = 0;
            switchScreen('game-screen');
            loadQuestion();
        }

        function loadQuestion() {
            // Soru sayac캼n캼 g칲ncelle
            document.getElementById('q-current').innerText = currentQIndex + 1;
            
            const q = gameQuestions[currentQIndex];
            
            // Sesi y칲kle (Otomatik ba륿atma, kullan캼c캼 t캼klas캼n)
            audioEl.src = q.audioSrc;
            stopAudio(); 

            // 뤣쎪lar캼 haz캼rla
            const area = document.getElementById('options-area');
            area.innerHTML = "";
            
            let opts = [...q.secenekler].sort(() => 0.5 - Math.random());
            
            opts.forEach(opt => {
                const btn = document.createElement('div');
                btn.className = 'option-btn';
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(btn, opt, q.dogru);
                area.appendChild(btn);
            });
        }

        function toggleAudio() {
            if (audioEl.paused) {
                audioEl.play().catch(e => alert("Ses dosyas캼 y칲klenemedi."));
                playIcon.className = "fas fa-pause audio-icon";
                ripple.className = "playing-animation";
                statusText.innerText = "Dinleniyor...";
            } else {
                stopAudio();
            }
        }
        
        function stopAudio() {
            audioEl.pause();
            playIcon.className = "fas fa-play audio-icon";
            ripple.className = "";
            statusText.innerText = "Cevap bekleniyor...";
        }

        function checkAnswer(btn, selected, correct) {
            stopAudio();
            const allBtns = document.querySelectorAll('.option-btn');
            allBtns.forEach(b => b.style.pointerEvents = 'none'); // T캼klamay캼 kilitle

            if (selected === correct) {
                // DORU CEVAP
                btn.classList.add('correct');
                statusText.innerHTML = "<span style='color:var(--correct)'>Doru!</span>";
                
                setTimeout(() => {
                    currentQIndex++;
                    if (currentQIndex < totalQuestions) {
                        loadQuestion();
                    } else {
                        endGame(true); // Kazand캼
                    }
                }, 1500);

            } else {
                // YANLI CEVAP (KAYBETT캻)
                btn.classList.add('wrong');
                statusText.innerHTML = "<span style='color:var(--wrong)'>Yanl캼! Dorusu: " + correct + "</span>";
                
                // Doruyu g칬ster
                allBtns.forEach(b => {
                   if(b.innerText === correct) b.classList.add('correct');
                });

                setTimeout(() => {
                    endGame(false); // Kaybetti
                }, 2000);
            }
        }

        function endGame(isWin) {
            switchScreen('result-screen');
            const iconContainer = document.getElementById('result-icon-container');
            const title = document.getElementById('result-title');
            const msg = document.getElementById('result-msg');
            const scoreDisplay = document.getElementById('final-score-display');

            if (isWin) {
                iconContainer.innerHTML = '<i class="fas fa-trophy" style="font-size: 5rem; color: var(--accent);"></i>';
                title.innerText = "TEBR캻KLER 칖STAT!";
                title.style.color = "var(--accent)";
                msg.innerText = "7 sorunun tamam캼n캼 doru bildiniz. G칬r칲n칲른 g칬re musiki를nas bir musiki gurmesisiniz. Muazzam bir kulak!游녪游낕";
                scoreDisplay.innerText = "Skor: 7 / 7";
            } else {
                iconContainer.innerHTML = '<i class="fas fa-heart-broken" style="font-size: 5rem; color: var(--wrong);"></i>';
                title.innerText = "ELEND캻N캻Z";
                title.style.color = "var(--wrong)";
                msg.innerText = "Maalesef yanl캼 cevap verdiniz. Fas캼l yar캼m kald캼.";
                scoreDisplay.innerText = "Ula캼lan Soru: " + (currentQIndex + 1) + " / 7";
            }
        }
    </script>
</body>
</html>
