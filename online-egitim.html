<!DOCTYPE html>
<html lang="tr">
<head>
    <link rel="shortcut icon" href="ikonn.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Eƒüitim | Mahmut Burak ASLANTA≈û</title>
    <meta name="description" content="Mahmut Burak ASLANTA≈û ile profesyonel online baƒülama eƒüitimi.">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&family=Poppins:wght@300;400;500;600&family=Lato&display=swap" rel="stylesheet">

    <script src='https://meet.jit.si/external_api.js'></script>

    <style>
        /* ============================================================
           TEMEL AYARLAR
           ============================================================ */
        :root {
            --primary: #000000;
            --accent: #c5a059;
            --bg-dark: #0f0f0f;
            --bg-sidebar: #151515;
            --bg-gradient: linear-gradient(135deg, #0a0a0a 0%, #161616 100%);
            --yellow-portal: #ffd700;
            --portal-glow: rgba(255, 215, 0, 0.3);
            --glass-bg: rgba(20, 20, 20, 0.65);
            --glass-border: rgba(255, 255, 255, 0.08);
            --text: #ffffff;
            --text-secondary: #b0b0b0;
            --whatsapp-green: #25d366;
            --ai-purple: #9d4edd;
            --sidebar-width: 280px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            font-family: 'Montserrat', sans-serif; 
            font-weight: 300;
            background: var(--bg-dark);
            background-image: var(--bg-gradient);
            color: var(--text); 
            line-height: 1.6;
            display: flex; flex-direction: column; min-height: 100vh;
            transition: background 0.5s ease;
        }

        body.portal-active {
            font-family: 'Poppins', sans-serif;
            background-color: #050505;
            background-image: radial-gradient(circle at 10% 20%, rgba(255, 215, 0, 0.03) 0%, transparent 20%),
                              radial-gradient(circle at 90% 80%, rgba(157, 78, 221, 0.05) 0%, transparent 20%);
        }

        /* --- Dƒ∞L SE√áƒ∞Cƒ∞ STƒ∞LLERƒ∞ --- */
        .language-wrapper {
            position: fixed;
            top: 25px;
            right: 30px;
            z-index: 1002;
            font-family: 'Montserrat', sans-serif;
        }
        .lang-btn {
            background: rgba(0, 0, 0, 0.6); 
            border: 1px solid var(--accent);
            color: #fff;
            padding: 8px 15px;
            border-radius: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .lang-btn:hover {
            background: rgba(197, 160, 89, 0.2);
            box-shadow: 0 0 10px rgba(197, 160, 89, 0.3);
        }
        .lang-dropdown {
            display: none;
            position: absolute;
            top: 120%;
            right: 0;
            background: rgba(10, 10, 10, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            overflow: hidden;
            min-width: 140px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
        }
        .lang-dropdown a {
            display: block;
            padding: 12px 15px;
            color: #ccc;
            text-decoration: none;
            font-size: 13px;
            transition: 0.2s;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .lang-dropdown a:last-child { border-bottom: none; }
        .lang-dropdown a:hover {
            background: var(--accent);
            color: #000;
        }
        .lang-dropdown.active {
            display: block;
            animation: fadeInDrop 0.3s ease;
        }
        @keyframes fadeInDrop {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- MEN√ú --- */
        nav { background: rgba(0, 0, 0, 0.95); padding: 20px 0; position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid rgba(197, 160, 89, 0.2); }
        .nav-container { display: flex; justify-content: center; align-items: center; max-width: 1200px; margin: 0 auto; position: relative; padding-right: 100px; }
        nav ul { display: flex; list-style: none; gap: 40px; padding: 0 20px; }
        nav a { color: var(--text-secondary); text-decoration: none; font-size: 0.8rem; font-weight: 500; text-transform: uppercase; letter-spacing: 2px; transition: all 0.3s ease; }
        nav a:hover, nav a.active { color: var(--accent); }
        .menu-toggle { display: none; font-size: 1.5rem; color: var(--accent); cursor: pointer; position: absolute; right: 20px; }

        /* --- LANDING CONTENT --- */
        .portal-login-btn-container { text-align: center; margin: 40px 0; display: flex; justify-content: center; }
        .portal-btn {
            background: var(--accent); border: 1px solid var(--accent); color: #000; padding: 20px 40px;
            font-family: 'Playfair Display', serif; font-size: 1.2rem; text-transform: uppercase; letter-spacing: 1px;
            cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 20px;
            border-radius: 5px; box-shadow: 0 0 15px rgba(197, 160, 89, 0.3);
        }
        .portal-btn:hover { background: #e0c060; transform: translateY(-3px); }
        
        /* ƒ∞KON STƒ∞Lƒ∞ (D√úZELTƒ∞LDƒ∞) */
        .icon-stack { position: relative; display: inline-block; width: 40px; height: 40px; flex-shrink: 0; }
        .icon-stack .fa-laptop { font-size: 36px; }
        .icon-stack .fa-music { position: absolute; font-size: 14px; top: 50%; left: 50%; transform: translate(-50%, -60%); color: #000; }

        .page-content { flex: 1; padding: 20px; max-width: 1400px; margin: 0 auto; width: 100%; animation: fadeInUp 1s ease-out forwards; opacity: 0; }
        @keyframes fadeInUp { 0% { opacity: 0; transform: translateY(20px); } 100% { opacity: 1; transform: translateY(0); } }
        
        h2, h3, h4 { font-family: 'Playfair Display', serif; color: var(--accent); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 15px; }

        .features-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 30px; margin-bottom: 50px; }
        .feature-card { background: rgba(255, 255, 255, 0.03); padding: 30px; border-left: 2px solid var(--accent); transition: transform 0.3s; }
        .feature-card:hover { transform: translateY(-5px); background: rgba(255, 255, 255, 0.05); }
        .feature-card i { font-size: 2rem; color: var(--accent); margin-bottom: 20px; }
        
        .apply-container { background: #050505; padding: 40px; border: 1px solid #222; max-width: 800px; margin: 0 auto; }
        .form-group { display: flex; flex-direction: column; gap: 15px; }
        input, select, textarea { background: rgba(0, 0, 0, 0.6); border: 1px solid #333; color: white; padding: 12px; font-family: 'Montserrat', sans-serif; outline: none; }
        input:focus { border-color: var(--accent); }
        .btn { padding: 12px 30px; border: 1px solid var(--accent); color: var(--accent); background: transparent; text-transform: uppercase; cursor: pointer; transition: 0.3s; font-weight: bold; }
        .btn:hover { background: var(--accent); color: #000; }

        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 9999; display: none; justify-content: center; align-items: center; flex-direction: column; animation: fadeIn 0.3s; }
        .login-box { border: 1px solid var(--accent); padding: 40px; text-align: center; background: #111; box-shadow: 0 0 30px rgba(197, 160, 89, 0.3); width: 90%; max-width: 400px; position: relative; }
        .close-login { position: absolute; top: 10px; right: 15px; color: #fff; font-size: 1.5rem; cursor: pointer; }

        /* ============================================================
           PORTAL STƒ∞LLERƒ∞
           ============================================================ */
        #student-portal { display: none; width: 100%; min-height: 80vh; margin-top: 30px; }
        .portal-layout { display: flex; gap: 30px; min-height: 80vh; }
        
        .sidebar { 
            width: var(--sidebar-width); 
            background: var(--glass-bg); 
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            padding: 30px; 
            border: 1px solid var(--glass-border); border-radius: 24px; 
            display: flex; flex-direction: column; 
            transition: all 0.3s ease; 
            max-height: 85vh; 
            position: sticky; top: 100px;
            overflow-y: auto; 
        }
        .sidebar::-webkit-scrollbar { width: 4px; }
        .sidebar::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }

        .sidebar.collapsed { width: 90px; padding: 30px 15px; }
        .sidebar.collapsed .user-info, .sidebar.collapsed .menu-title { display: none; }
        .sidebar.collapsed .menu-link span, .sidebar.collapsed .whatsapp-sidebar-btn span { display: none; }
        .sidebar.collapsed .menu-link { justify-content: center; padding: 15px 0; }
        .hamburger-btn { font-size: 1.5rem; color: var(--yellow-portal); cursor: pointer; margin-bottom: 20px; align-self: flex-end; }
        
        .user-info { margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 20px; text-align: center; }
        .user-name { color: var(--yellow-portal); font-family: 'Lato', sans-serif; font-size: 1.4rem; font-weight: normal; line-height: 1.2; margin-bottom: 5px; }
        .premium-badge { font-size: 0.65rem; color: #000; background: var(--yellow-portal); padding: 4px 10px; border-radius: 20px; display: inline-block; letter-spacing: 1px; text-transform: uppercase; font-weight: bold; box-shadow: 0 0 10px var(--portal-glow); margin-top: 10px; }
        
        /* --- PROFƒ∞L FOTOƒûRAFI STƒ∞Lƒ∞ --- */
        .profile-container {
            width: 100px; height: 100px; margin: 0 auto 15px auto;
            position: relative; cursor: pointer; border-radius: 50%;
            border: 2px solid var(--accent); padding: 2px;
            transition: transform 0.3s;
        }
        .profile-container:hover { transform: scale(1.05); }
        .profile-container img {
            width: 100%; height: 100%; object-fit: cover; border-radius: 50%;
        }
        .edit-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            opacity: 0; transition: 0.3s;
        }
        .profile-container:hover .edit-overlay { opacity: 1; }
        .edit-overlay i { color: #fff; font-size: 1.5rem; }

        .menu-link { display: flex; align-items: center; gap: 15px; color: #ccc; text-decoration: none; padding: 12px 15px; margin-bottom: 5px; border-radius: 12px; transition: 0.3s; cursor: pointer; font-size: 0.95rem; border: 1px solid transparent; }
        .menu-link:hover { background: rgba(255, 255, 255, 0.05); color: #fff; transform: translateX(5px); }
        .menu-link.active { background: linear-gradient(90deg, rgba(255, 215, 0, 0.15) 0%, transparent 100%); color: var(--yellow-portal); border-left: 3px solid var(--yellow-portal); border-radius: 4px 12px 12px 4px; }
        
        .whatsapp-sidebar-btn { display: flex; align-items: center; gap: 15px; background: linear-gradient(135deg, #25d366 0%, #128c7e 100%); color: white; padding: 15px; border-radius: 15px; text-decoration: none; font-weight: 600; margin-top: auto; transition: 0.3s; justify-content: center; box-shadow: 0 5px 15px rgba(37, 211, 102, 0.2); }
        .whatsapp-sidebar-btn:hover { transform: scale(1.02); box-shadow: 0 8px 20px rgba(37, 211, 102, 0.4); }

        .portal-content { flex: 1; border-radius: 24px; padding: 10px; }
        .view-section { display: none; animation: fadeIn 0.5s; }
        .view-section.active { display: block; }
        
        .dashboard-header h1 { font-family: 'Lato', sans-serif; color: var(--yellow-portal); margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; font-weight: normal; letter-spacing: 1px; }
        .dashboard-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        
        .dash-card { background: var(--glass-bg); backdrop-filter: blur(10px); border: 1px solid var(--glass-border); padding: 40px 30px; text-align: center; border-radius: 20px; cursor: pointer; transition: 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); position: relative; overflow: hidden; }
        .dash-card:hover { transform: translateY(-8px); border-color: var(--yellow-portal); box-shadow: 0 15px 30px rgba(0,0,0,0.3); }
        .dash-card i { font-size: 3.5rem; color: var(--yellow-portal); margin-bottom: 20px; transition: 0.3s; }
        .dash-card:hover i { transform: scale(1.1); text-shadow: 0 0 20px var(--portal-glow); }
        .custom-icon { width: 80px; height: auto; margin-bottom: 20px; filter: grayscale(100%) brightness(200%); transition: 0.4s; display: block; margin-left: auto; margin-right: auto;}
        .dash-card:hover .custom-icon { filter: none; transform: scale(1.1); }
        
        .ai-card { border: 1px solid rgba(157, 78, 221, 0.3); background: linear-gradient(160deg, rgba(20, 20, 20, 0.8) 0%, rgba(157, 78, 221, 0.05) 100%); }
        .ai-card:hover { border-color: var(--ai-purple); box-shadow: 0 0 25px rgba(157, 78, 221, 0.2); }
        .ai-card i { color: var(--ai-purple) !important; }
        .ai-badge { position: absolute; top: 15px; right: 15px; background: var(--ai-purple); color: white; font-size: 0.65rem; padding: 4px 10px; border-radius: 20px; font-weight: bold; z-index: 2; box-shadow: 0 0 10px rgba(157, 78, 221, 0.5); }

        .chat-container { display: flex; flex-direction: column; height: 65vh; border: 1px solid var(--glass-border); border-radius: 24px; overflow: hidden; background: rgba(10, 10, 10, 0.6); backdrop-filter: blur(10px); }
        .chat-box { flex: 1; padding: 25px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"); }
        .chat-message { max-width: 75%; padding: 15px 20px; border-radius: 18px; font-size: 0.95rem; line-height: 1.5; position: relative; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .chat-message.ai { align-self: flex-start; background: rgba(40, 40, 40, 0.9); border-bottom-left-radius: 2px; color: #eee; border: 1px solid rgba(255,255,255,0.05); }
        .chat-message.ai strong { color: var(--yellow-portal); }
        .chat-message.user { align-self: flex-end; background: linear-gradient(135deg, var(--yellow-portal) 0%, #b8860b 100%); color: #000; border-bottom-right-radius: 2px; font-weight: 500; }
        
        .chat-input-area { padding: 20px; background: rgba(20, 20, 20, 0.9); border-top: 1px solid var(--glass-border); display: flex; gap: 12px; align-items: center; }
        .chat-input { flex: 1; background: rgba(255, 255, 255, 0.05); border: 1px solid #444; color: white; padding: 12px 20px; border-radius: 30px; outline: none; transition: 0.3s; }
        .chat-input:focus { border-color: var(--yellow-portal); background: rgba(255, 255, 255, 0.1); }
        .chat-action-btn, .chat-mute-btn { background: transparent; border: none; color: #888; padding: 10px; cursor: pointer; transition: 0.2s; font-size: 1.1rem; }
        .chat-action-btn:hover { color: var(--yellow-portal); transform: scale(1.1); }
        .chat-mute-btn:hover { color: red; }
        .chat-send-btn { background: var(--yellow-portal); color: black; border: none; width: 45px; height: 45px; border-radius: 50%; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 15px var(--portal-glow); transition: 0.3s; }
        .chat-send-btn:hover { transform: scale(1.1); }

        .category-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .cat-box { background: var(--glass-bg); padding: 30px; border-radius: 12px; border-left: 4px solid var(--yellow-portal); cursor: pointer; transition: 0.3s; border: 1px solid var(--glass-border); border-left-width: 4px; }
        .cat-box:hover { background: rgba(255, 255, 255, 0.05); transform: translateX(5px); }
        .cat-title { color: var(--yellow-portal); font-family: 'Playfair Display', serif; font-size: 1.3rem; display: block; margin-bottom: 8px; }
        .materials-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-top: 20px; }
        .mat-item { background: var(--glass-bg); border: 1px solid var(--glass-border); padding: 25px 15px; text-align: center; border-radius: 15px; cursor: pointer; transition: 0.3s; text-decoration: none; }
        .mat-item:hover { border-color: var(--yellow-portal); transform: translateY(-5px); background: rgba(255,255,255,0.02); }
        .exam-row { background: var(--glass-bg); padding: 20px 25px; border-radius: 12px; margin-bottom: 10px; border: 1px solid var(--glass-border); display: flex; justify-content: space-between; align-items: center; cursor: pointer; transition: 0.2s; }
        .exam-row:hover { border-color: var(--yellow-portal); background: rgba(255,255,255,0.05); }
        .exam-detail-container { background: var(--glass-bg); padding: 40px; border-radius: 20px; border: 1px solid var(--glass-border); margin-top: 20px; }
        .answer-key-btn { background: rgba(0,0,0,0.3); color: #fff; padding: 20px; width: 100%; text-align: center; border: 1px dashed var(--yellow-portal); border-radius: 10px; cursor: pointer; font-size: 1.1rem; transition: 0.3s; margin-top: 30px; }
        .answer-key-btn:hover { background: var(--yellow-portal); color: #000; border-style: solid; }

        .image-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); backdrop-filter: blur(10px); z-index: 10000; display: none; justify-content: center; align-items: center; }
        .image-modal img { max-width: 90%; max-height: 90%; border: 3px solid var(--yellow-portal); border-radius: 10px; }
        .close-modal { position: absolute; top: 30px; right: 40px; color: #fff; font-size: 3rem; cursor: pointer; }
        
        #imagePreviewContainer { 
            display: none; position: absolute; bottom: 85px; left: 30px; 
            background: rgba(0,0,0,0.8); padding: 10px; 
            border: 1px solid var(--yellow-portal); border-radius: 10px; 
            z-index: 10; backdrop-filter: blur(5px); 
        }
        #imagePreview { max-width: 120px; max-height: 120px; display: block; border-radius: 5px; }
        #removeImage { color: #ff4d4d; cursor: pointer; text-align: center; display: block; margin-top: 8px; font-size: 0.85rem; font-weight: bold; }

        .live-class-card { border-color: rgba(255, 0, 0, 0.3); }
        .live-class-card:hover { border-color: red; box-shadow: 0 0 20px rgba(255,0,0,0.3); }
        .live-class-card i { color: #ff4d4d; }
        #meet-frame { width: 100%; height: 600px; background: #000; border-radius: 15px; overflow: hidden; border: 1px solid var(--glass-border); }

        /* --- METRONOM STƒ∞LLERƒ∞ --- */
        .metronome-container {
            background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 20px;
            padding: 40px; max-width: 600px; margin: 20px auto; text-align: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.5); backdrop-filter: blur(10px);
        }
        .beat-dots { display: flex; justify-content: center; gap: 15px; margin-bottom: 30px; height: 30px; }
        .beat-dot { width: 20px; height: 20px; border-radius: 50%; background: rgba(255,255,255,0.1); border: 1px solid #444; transition: all 0.1s; }
        .beat-dot.active { background: var(--yellow-portal); box-shadow: 0 0 15px var(--yellow-portal); transform: scale(1.3); border-color: #fff; }
        .bpm-display-area { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px; }
        .bpm-value-box { font-family: 'Lato', sans-serif; font-size: 4rem; font-weight: 300; color: var(--text); width: 180px; line-height: 1; }
        .bpm-label { display: block; font-size: 0.9rem; color: var(--accent); letter-spacing: 2px; margin-top: 5px; }
        .bpm-btn { width: 50px; height: 50px; border-radius: 50%; border: 1px solid var(--accent); background: transparent; color: var(--accent); font-size: 1.5rem; cursor: pointer; transition: 0.2s; }
        .bpm-btn:hover { background: var(--accent); color: #000; }
        .slider-container { width: 100%; margin-bottom: 40px; }
        .bpm-slider { -webkit-appearance: none; width: 100%; height: 6px; background: #333; border-radius: 5px; outline: none; }
        .bpm-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 24px; height: 24px; border-radius: 50%; background: var(--yellow-portal); cursor: pointer; box-shadow: 0 0 10px rgba(255, 215, 0, 0.5); transition: transform 0.2s; }
        .bpm-slider::-webkit-slider-thumb:hover { transform: scale(1.2); }
        .controls-row { display: flex; gap: 20px; justify-content: center; align-items: center; flex-wrap: wrap; }
        .select-wrapper select { padding: 15px 20px; border-radius: 30px; background: rgba(0,0,0,0.4); border: 1px solid var(--accent); color: #fff; font-size: 1rem; cursor: pointer; outline: none; }
        .play-btn { padding: 15px 40px; border-radius: 30px; background: var(--yellow-portal); color: #000; border: none; font-weight: bold; font-size: 1.1rem; cursor: pointer; display: flex; align-items: center; gap: 10px; box-shadow: 0 0 20px rgba(255, 215, 0, 0.2); transition: 0.3s; }
        .play-btn:hover { transform: scale(1.05); box-shadow: 0 0 30px rgba(255, 215, 0, 0.4); }
        .play-btn.playing { background: #ff4d4d; color: white; }

        /* --- AKORT Cƒ∞HAZI STƒ∞LLERƒ∞ --- */
        .tuner-container { background: var(--glass-bg); border: 1px solid var(--glass-border); border-radius: 20px; padding: 30px; max-width: 500px; margin: 20px auto; text-align: center; box-shadow: 0 0 30px rgba(0,0,0,0.5); backdrop-filter: blur(10px); }
        #tunerGauge { width: 100%; max-width: 400px; height: auto; margin-bottom: 10px; }
        .note-display { font-family: 'Lato', sans-serif; font-weight: bold; color: var(--text); text-shadow: 0 0 20px rgba(255, 215, 0, 0.2); margin-bottom: 5px; }
        #noteName { font-size: 5rem; color: var(--yellow-portal); }
        #noteOctave { font-size: 2rem; color: var(--text-secondary); }
        .frequency-display { font-family: 'Montserrat', sans-serif; color: var(--accent); font-size: 1.2rem; letter-spacing: 1px; }
        .tuner-btn-active { background: #ff4d4d !important; color: white !important; box-shadow: 0 0 20px rgba(255, 77, 77, 0.4) !important; }

        @media (max-width: 900px) {
            .portal-layout { flex-direction: column; }
            .sidebar { width: 100%; height: auto; position: relative; top: 0; padding: 20px; border-radius: 0; border: none; border-bottom: 1px solid var(--glass-border); background: var(--bg-dark); max-height: none; }
            .sidebar.collapsed { height: 70px; overflow: hidden; padding: 15px 20px; }
            .sidebar.collapsed .user-info, .sidebar.collapsed .menu-title { display: none; }
            .nav-container { display: flex; justify-content: space-between; padding: 0 20px; }
            nav ul { display: none; flex-direction: column; position: absolute; top: 100%; left: 0; width: 100%; background: #000; padding: 20px 0; border-bottom: 1px solid var(--accent); }
            nav ul.aktif { display: flex; }
            .menu-toggle { display: block; position: static; }
            .chat-container { height: 50vh; }
            .language-wrapper { top: 20px; right: 70px; }
            .lang-btn span { display: none; }
            .nav-container { padding-right: 0; }
        }

        footer { background: #050505; padding: 40px 20px; text-align: center; border-top: 1px solid #1a1a1a; margin-top: auto; }
        .social-wrapper { display: flex; justify-content: center; gap: 30px; margin-bottom: 20px; }
        .social-item { color: #555; font-size: 1.5rem; transition: 0.3s; }
        .social-item:hover { color: var(--accent); }
    </style>
</head>
<body>

    <div class="language-wrapper">
        <button class="lang-btn" onclick="toggleLanguageMenu()">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="2" y1="12" x2="22" y2="12"></line>
                <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
            </svg>
            <span>Language</span>
        </button>
        
        <div class="lang-dropdown" id="langDropdown">
            <a href="javascript:void(0)" onclick="changeLanguage('tr')">üáπüá∑ T√ºrk√ße</a>
            <a href="javascript:void(0)" onclick="changeLanguage('en')">üá¨üáß English</a>
        </div>
    </div>

    <nav>
        <div class="nav-container">
            <div class="menu-toggle" onclick="menuyuAcKapa()">
                <i class="fas fa-bars"></i>
            </div>
            <ul id="anaMenu">
                <li><a href="index.html" data-lang="menu_home">ANA SAYFA</a></li>
                <li><a href="hakkinda.html" data-lang="menu_about">HAKKINDA</a></li>
                <li><a href="online-egitim.html" class="active" data-lang="menu_edu">ONLINE Eƒûƒ∞Tƒ∞M</a></li>
                <li><a href="notalar.html" data-lang="menu_notes">NOTALAR</a></li>
                <li><a href="siirler.html" data-lang="menu_poems">≈ûƒ∞ƒ∞RLER</a></li>
                <li><a href="konserler.html" data-lang="menu_concerts">KONSERLER</a></li>
            </ul>
        </div>
    </nav>

    <div id="login-overlay">
       
  <div class="login-box">
    <span class="close-login" onclick="girisKapat()">√ó</span>
    <h3 style="color: var(--accent); margin-bottom: 20px;" data-lang="portal_title">√ñƒûRENCƒ∞ PORTALI</h3>
    
    <input type="email" id="emailInput" placeholder="E-posta Adresiniz" data-lang-placeholder="ph_email" style="width: 100%; padding: 12px; margin-bottom: 15px; background: #222; border: 1px solid #444; color: white; border-radius: 5px;">
    
    <input type="password" id="passwordInput" placeholder="≈ûifreniz" data-lang-placeholder="ph_pass" style="width: 100%; padding: 12px; margin-bottom: 10px; background: #222; border: 1px solid #444; color: white; border-radius: 5px;">
    
    <div style="text-align: right; margin-bottom: 20px;">
        <span onclick="sifreSifirla()" style="color: #bbb; cursor: pointer; font-size: 0.85rem; text-decoration: underline; transition: 0.3s;" onmouseover="this.style.color='var(--accent)'" onmouseout="this.style.color='#bbb'" data-lang="forgot_pass">
            ≈ûifremi Unuttum
        </span>
    </div>
    <button id="firebaseLoginBtn" class="btn" style="width: 100%; background: var(--accent); color: black; font-weight: bold; padding: 12px;" data-lang="btn_login">Gƒ∞Rƒ∞≈û YAP</button>
    
    <p id="loginStatus" style="margin-top: 15px; font-size: 0.9rem; min-height: 20px;"></p>
</div>
 
    </div>

    <div class="page-content">
        
        <div id="portal-entry-btn-section" class="portal-login-btn-container">
            <button onclick="girisAc()" class="portal-btn">
                <div class="icon-stack">
                    <i class="fas fa-laptop"></i>
                    <i class="fas fa-music"></i>
                </div>
                <span data-lang="btn_enter_portal">√ñƒûRENCƒ∞ PORTALINA Gƒ∞Rƒ∞≈û YAP</span>
            </button>
        </div>

        <div id="public-content">
            <div style="text-align: center; margin-bottom: 50px;">
                <h2 data-lang="public_h2">Neden Online Eƒüitim?</h2>
                <div style="width: 60px; height: 2px; background: var(--accent); margin: 15px auto;"></div>
            </div>
            <div class="features-grid">
                <div class="feature-card">
                    <i class="fas fa-robot"></i>
                    <h4 data-lang="feat_ai_title">Yapay Zeka ile Eƒüitim</h4>
                    <p data-lang="feat_ai_desc">Yapay zeka destekli m√ºzik √∂ƒüretmeniniz BurakAI ile eƒüitimde yeni bir d√∂nem. Bu teknolojiyi kullanmak ve derslerinize entegre etmek i√ßin a≈üaƒüƒ±daki formu doldurarak ders paketlerimizi satƒ±n alabilirsiniz.</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-moon"></i>
                    <h4 data-lang="feat_time_title">Mesai Sonrasƒ± Sanat</h4>
                    <p data-lang="feat_time_desc">√áoƒüu kurs ak≈üam 19:00'da kapƒ±larƒ±nƒ± kapatƒ±r. Biz ise tam o saatlerde ba≈ülƒ±yoruz. ƒ∞≈üten eve d√∂nd√ºƒü√ºn√ºzde, trafiƒüe girmeden ve kurs saatlerine yeti≈üme stresi ya≈üamadan baƒülamanƒ±zƒ± elinize alƒ±n.</p>
                </div>
                <div class="feature-card"><i class="fas fa-user-tie"></i><h4 data-lang="feat_premium_title">Premium √ñƒürenci Portalƒ±</h4><p data-lang="feat_premium_desc">Bu b√∂l√ºmde, yalnƒ±zca kendinize √∂zel verilen ≈üifre ile eri≈üebileceƒüiniz ders materyalleri yer almaktadƒ±r. T√ºm i√ßerikler, √∂ƒürenme s√ºrecini desteklemek amacƒ±yla sesli ve g√∂rsel materyallerle hazƒ±rlanmƒ±≈ütƒ±r. Materyaller d√ºzenli olarak g√ºncellenmekte ve seviyelere g√∂re yapƒ±landƒ±rƒ±lmaktadƒ±r.</p></div>
                <div class="feature-card"><i class="fab fa-whatsapp"></i><h4 data-lang="feat_comm_title">Kesintisiz ƒ∞leti≈üim</h4><p data-lang="feat_comm_desc">Ders bittiƒüinde baƒüƒ±mƒ±z kopmaz, Dilediƒüiniz zaman WhatsApp √ºzerinden √∂devlerinizi g√∂nderip, kafanƒ±za takƒ±lan sorularƒ± sorup, videolarƒ±nƒ±zƒ± g√∂nderebilirsiniz. Bu √∂zelliƒüe sadece √∂ƒürenci portalƒ± √ºzerinden eri≈üim saƒülayabilirsiniz.</p></div>
            </div>
            <div class="apply-container">
                <h3 style="text-align: center; margin-bottom: 25px;" data-lang="apply_title">BA≈ûVURU FORMU</h3>
                <form action="https://formspree.io/f/xnjvyknz" method="POST" class="form-group">
                    <input type="text" name="ad_soyad" placeholder="Ad Soyad" data-lang-placeholder="ph_name" required>
                    <input type="tel" name="telefon" placeholder="Telefon Numaranƒ±z" data-lang-placeholder="ph_phone" required>
                    <div style="display: flex; gap: 10px;"><input type="number" name="yas" placeholder="Ya≈ü (16+)" data-lang-placeholder="ph_age" min="16" required style="flex:1;"><input type="text" name="meslek" placeholder="Meslek (Opsiyonel)" data-lang-placeholder="ph_job" style="flex:1;"></div>
                    <select name="seviye" id="levelSelect"><option value="" disabled selected data-lang="ph_level">Mevcut Seviyeniz</option><option value="sifir" data-lang="level_0">Hi√ß Bilmiyorum</option><option value="temel" data-lang="level_1">Temel Seviye</option><option value="ileri" data-lang="level_2">ƒ∞leri Seviye</option></select>
                    <textarea name="mesaj" rows="4" placeholder="M√ºzikal hedefleriniz..." data-lang-placeholder="ph_goals" required></textarea>
                    <button type="submit" class="btn" style="width: 100%;" data-lang="btn_send">G√ñNDER</button>
                </form>
            </div>
        </div>

        <div id="student-portal">
            <div class="portal-layout">
                
                <div class="sidebar" id="sidebar">
                    <div class="hamburger-btn" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </div>
                    
                    <div class="user-info">
                        <div class="profile-container" onclick="document.getElementById('profileUpload').click()">
                            <img id="userAvatar" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Profil">
                            <div class="edit-overlay"><i class="fas fa-camera"></i></div>
                            <input type="file" id="profileUpload" accept="image/*" style="display: none;" onchange="saveProfilePhoto(this)">
                        </div>
                        <div class="user-name" id="displayAd">Ad</div>
                        <div class="user-name" id="displaySoyad" style="text-transform: uppercase;">SOYAD</div>
                        
                        
                        <div class="premium-badge" data-lang="badge_premium">PREMIUM √úYE</div>
                    </div>

                    <div class="menu-links">
                        <a onclick="sayfaGoster('dashboard-view')" class="menu-link active">
                            <i class="fas fa-home"></i> <span data-lang="sb_home">Ana Sayfa</span>
                        </a>
                        <br>
                        <div style="color: #666; font-size: 0.8rem; margin-bottom: 5px; padding-left: 12px;" class="menu-title" data-lang="sb_edu_title">Eƒûƒ∞Tƒ∞MLERƒ∞M</div>
                        <a onclick="sayfaGoster('baglama-menu-view')" class="menu-link">
                            <i class="fas fa-music"></i> <span data-lang="sb_baglama">Baƒülama Eƒüitimi</span>
                        </a>
                        <a onclick="sayfaGoster('exam-categories-view')" class="menu-link">
                            <i class="fas fa-edit"></i> <span data-lang="sb_exam">Yetenek Sƒ±navƒ± Hazƒ±rlƒ±k</span>
                        </a>
                        
                        <div style="color: #666; font-size: 0.8rem; margin: 15px 0 5px 0; padding-left: 12px;" class="menu-title" data-lang="sb_tools_title">ARA√áLAR</div>
                        <a onclick="sayfaGoster('metronome-view')" class="menu-link">
                            <i class="fas fa-stopwatch"></i> <span data-lang="sb_metro">Metronom</span>
                        </a>
                        <a onclick="sayfaGoster('tuner-view')" class="menu-link">
                            <i class="fas fa-microphone-lines"></i> <span data-lang="sb_tuner">Akort Cihazƒ±</span>
                        </a>

                        <a onclick="startLiveClass()" class="menu-link">
                             <i class="fas fa-video"></i> <span data-lang="sb_live">Canlƒ± Ders</span>
                        </a>
                        <a onclick="sayfaGoster('ai-mentor-view')" class="menu-link" style="color: var(--accent);">
                            <i class="fas fa-robot"></i> <span data-lang="sb_ai">BurakAI Hoca (beta)</span>
                        </a>
                    </div>

                    <a href="https://wa.me/905335060921" target="_blank" class="whatsapp-sidebar-btn">
                        <i class="fab fa-whatsapp"></i> <span data-lang="sb_emergency">Acil Durumlar ƒ∞√ßin</span>
                    </a>
                </div>

                <div class="portal-content">
                    
                    <div id="dashboard-view" class="view-section active">
                        <div class="dashboard-header">
                            <h1 id="welcomeTitle">Merhaba!</h1>
                        </div>
                        <br>
                        <div class="dashboard-grid">
                            <div class="dash-card" onclick="sayfaGoster('baglama-menu-view')">
                                <img src="baglama-ikon.png" class="custom-icon" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block'">
                                <i class="fas fa-music" style="display:none; font-size:3rem; color:var(--yellow-portal); margin-bottom:20px;"></i>
                                <h3 data-lang="card_baglama_title">BAƒûLAMA Eƒûƒ∞Tƒ∞Mƒ∞</h3>
                                <p data-lang="card_baglama_desc">Ders notlarƒ±, notalar ve egzersizleri.</p>
                            </div>

                            <div class="dash-card ai-card" onclick="sayfaGoster('ai-mentor-view')">
                                <span class="ai-badge" data-lang="badge_new">YENƒ∞</span>
                                <i class="fas fa-robot"></i>
                                <h3 data-lang="card_ai_title">BurakAI Hoca (beta)</h3>
                                <p style="font-size: 0.9rem; opacity: 0.9;" data-lang="card_ai_desc1">Yapay Zeka Entegrasyonlu ƒ∞lk M√ºzik Eƒüitim Platformu.</p>
                                <p style="font-size: 0.8rem; color: #aaa; margin-top: 10px;" data-lang="card_ai_desc2">7/24 Emrinizdeyim. T√ºrkiye'de Bir ƒ∞lk!</p>
                            </div>

                            <div class="dash-card" onclick="sayfaGoster('exam-categories-view')">
                                <i class="fas fa-graduation-cap"></i>
                                <h3 data-lang="card_exam_title">YETENEK SINAVINA HAZIRLIK</h3>
                                <p data-lang="card_exam_desc">Konservatuvar, M√ºzik √∂ƒüretmenliƒüi ve GSL'ye hazƒ±rlƒ±k i√ßin √∂ƒüretim materyalleri.</p>
                            </div>
                            
                            <div class="dash-card live-class-card" onclick="startLiveClass()">
                                <i class="fas fa-video"></i>
                                <h3 data-lang="card_live_title">CANLI DERS</h3>
                                <p data-lang="card_live_desc">Sanal sƒ±nƒ±fa baƒülanarak canlƒ± derse katƒ±lƒ±n.</p>
                                
                            </div>
                        </div>
                    </div>

                    <div id="ai-mentor-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 style="font-family: 'Playfair Display', serif; color: var(--accent); letter-spacing: 1px;" data-lang="ai_header">BurakAI Hoca</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem; transition:0.3s;" data-lang="btn_back">‚Üê Geri</button>
                        </div>
                        <p style="color: #bbb; margin-bottom: 20px; font-family: 'Poppins', sans-serif;" data-lang="ai_intro">Kafana takƒ±lan her ≈üeyi sorabilirsin, ben senin i√ßin burdayƒ±m ciƒüerim.</p>
                        
                        <div class="chat-container">
                            <div class="chat-box" id="aiChatBox">
                                <div class="chat-message ai">
                                    <strong style="color: var(--accent); font-family: 'Playfair Display', serif;">BurakAI Hoca:</strong><br>
                                    <span data-lang="ai_welcome_msg">Gel bakalƒ±m evladƒ±m, ho≈ü geldin. Sazƒ±n kucaƒüƒ±ndaysa, g√∂nl√ºn de a≈üka hazƒ±rsa a≈üamayacaƒüƒ±mƒ±z yoku≈ü yok. 'Yorulduk' demek yok, 'yapamƒ±yorum' demek yok. Ben senin her adƒ±mda yanƒ±ndayƒ±m. Hadi bismillah diyelim, sor bakalƒ±m kafana takƒ±lan ≈üey nedir?</span>
                                </div>
                            </div>
                            
                            <div id="imagePreviewContainer">
                                <img id="imagePreview" src="" />
                                <span id="removeImage" data-lang="btn_remove">Kaldƒ±r</span>
                            </div>

                            <div class="chat-input-area">
                                <input type="file" id="fileInput" accept="image/*" style="display: none;">
                                
                                <button class="chat-action-btn" title="Fotoƒüraf Y√ºkle" onclick="triggerFileUpload()">
                                    <i class="fas fa-camera"></i>
                                </button>
                                <button class="chat-action-btn" title="Video Y√ºkle" onclick="alertVideoFeature()">
                                    <i class="fas fa-video"></i>
                                </button>
                                
                                <input type="text" class="chat-input" placeholder="Bir soru sor..." data-lang-placeholder="ph_chat" id="aiUserInput">
                                
                                <button class="chat-mute-btn" title="Okumayƒ± Durdur" onclick="window.speechSynthesis.cancel()">
                                    <i class="fas fa-volume-mute"></i>
                                </button>
                                
                                <button class="chat-send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
                            </div>
                        </div>
                    </div>

                    <div id="metronome-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 data-lang="metro_title">Metronom</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem;" data-lang="btn_back">‚Üê Geri</button>
                        </div>

                        <div class="metronome-container">
                            <div class="beat-dots" id="beatDots">
                                <div class="beat-dot active"></div>
                                <div class="beat-dot"></div>
                                <div class="beat-dot"></div>
                                <div class="beat-dot"></div>
                            </div>

                            <div class="bpm-display-area">
                                <button class="bpm-btn" onclick="changeBpm(-1)">-</button>
                                <div class="bpm-value-box">
                                    <span id="bpmDisplay">100</span>
                                    <span class="bpm-label">BPM</span>
                                </div>
                                <button class="bpm-btn" onclick="changeBpm(1)">+</button>
                            </div>

                            <div class="slider-container">
                                <input type="range" min="40" max="240" value="100" class="bpm-slider" id="bpmSlider" oninput="updateBpmFromSlider(this.value)">
                            </div>

                            <div class="controls-row">
                                <div class="select-wrapper">
                                    <select id="measureSelect" onchange="createDots()">
                                        <option value="2">2/4 (Halay/Oyun)</option>
                                        <option value="3">3/4 (Vals/Semah)</option>
                                        <option value="4" selected>4/4 (Deyi≈ü)</option>
                                        <option value="5">5/8 (Aksak)</option>
                                        <option value="6">6/8 (Azeri)</option>
                                        <option value="7">7/8 (Karadeniz/Devr-i Turan)</option>
                                        <option value="9">9/8 (Roman/Zeybek)</option>
                                    </select>
                                </div>
                                
                                <button class="play-btn" id="playBtn" onclick="toggleMetronome()">
                                    <i class="fas fa-play"></i> <span data-lang="btn_start">BA≈ûLAT</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div id="tuner-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 data-lang="tuner_title">Akort Cihazƒ±</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem;" data-lang="btn_back">‚Üê Geri</button>
                        </div>

                        <div class="tuner-container">
                            <canvas id="tunerGauge" width="400" height="250"></canvas>
                            
                            <div class="note-display">
                                <span id="noteName">--</span>
                                <span id="noteOctave"></span>
                            </div>
                            
                            <div class="frequency-display">
                                <span id="frequencyValue">0.0</span> Hz
                            </div>

                            <p id="tunerStatus" style="color:#888; font-size: 0.9rem; margin: 15px 0;" data-lang="tuner_instr">Ba≈ülamak i√ßin butona bas ve teline vur.</p>

                            <button class="play-btn" id="tunerBtn" onclick="toggleTuner()">
                                <i class="fas fa-microphone"></i> <span id="tunerBtnText" data-lang="btn_tuner_start">AKORTU BA≈ûLAT</span>
                            </button>
                            
                            <div style="margin-top: 30px; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 20px; text-align: left; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                                <div>
                                    <h4 style="color:var(--accent); font-size: 0.85rem; margin-bottom:5px;" data-lang="short_neck">KISA SAP</h4>
                                    <p style="font-size: 0.8rem; color: #ccc; line-height: 1.4;">
                                        Alt: <strong>F (Fa)</strong> / E (Mi)<br>
                                        Orta: <strong>Bb (Si Bemol)</strong> / A (La)<br>
                                        √úst: <strong>C (Do)</strong> / B (Si)
                                    </p>
                                </div>
                                <div>
                                    <h4 style="color:var(--accent); font-size: 0.85rem; margin-bottom:5px;" data-lang="long_neck">UZUN SAP</h4>
                                    <p style="font-size: 0.8rem; color: #ccc; line-height: 1.4;">
                                        Alt: <strong>Si (A) / Do (C)</strong><br>
                                        Orta: <strong>Mi (E) / Fa (F)</strong><br>
                                        √úst: <strong>La (A) / La# (A#)</strong>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="live-class-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 data-lang="live_title">Sanal Sƒ±nƒ±f</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem; transition:0.3s;" data-lang="btn_back">‚Üê Geri</button>
                        </div>
                        <div id="meet-frame"></div>
                    </div>

                    <div id="baglama-menu-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 data-lang="baglama_edu_title">Baƒülama Eƒüitimi</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem;" data-lang="btn_back">‚Üê Geri</button>
                        </div>
                        <br>
                        <div class="category-grid">
                            <div class="cat-box" onclick="materyalAc('Teorik Bilgi')"><span class="cat-title" data-lang="cat_theory">Ders Notlarƒ± (Teorik Bilgi)</span><span class="cat-desc" data-lang="desc_theory">M√ºzik teorisi ve makamlar.</span></div>
                            <div class="cat-box" onclick="materyalAc('Kƒ±sa Sap Notalarƒ±')"><span class="cat-title" data-lang="cat_short">Kƒ±sa Sap T√ºrk√º Notalarƒ±</span><span class="cat-desc" data-lang="desc_short">Kƒ±sa sap repertuvarƒ±.</span></div>
                            <div class="cat-box" onclick="materyalAc('Uzun Sap Notalarƒ±')"><span class="cat-title" data-lang="cat_long">Uzun Sap T√ºrk√º Notalarƒ±</span><span class="cat-desc" data-lang="desc_long">Uzun sap icra teknikleri.</span></div>
                            <div class="cat-box" onclick="materyalAc('Parmak Egzersizleri')"><span class="cat-title" data-lang="cat_ex">Parmak Egzersizleri</span><span class="cat-desc" data-lang="desc_ex">Hƒ±z ve teknik geli≈ütirici et√ºtler.</span></div>
                        </div>
                    </div>

                    <div id="materials-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 id="mat-category-title">Materyaller</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem;" data-lang="btn_back">‚Üê Geri</button>
                        </div>
                        <div class="materials-grid" id="materials-container">
                            </div>
                    </div>

                    <div id="exam-categories-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 data-lang="exam_prep_title">Yetenek Sƒ±navƒ± Hazƒ±rlƒ±k</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem;" data-lang="btn_back">‚Üê Geri</button>
                        </div>
                        <br>
                        <div class="category-grid">
                            <div class="cat-box" onclick="yetenekKategoriAc('Dikte Sorularƒ±')"><span class="cat-title" data-lang="cat_dictation">Dikte Sorularƒ±</span><span class="cat-desc" data-lang="desc_dictation">ƒ∞≈üitme ve yazma √ßalƒ±≈ümalarƒ±.</span></div>
                            <div class="cat-box" onclick="yetenekKategoriAc('Ritim Tekrarƒ± Sorularƒ±')"><span class="cat-title" data-lang="cat_rhythm">Ritim Tekrarƒ± Sorularƒ±</span><span class="cat-desc" data-lang="desc_rhythm">Ritim kulaƒüƒ±nƒ± geli≈ütirme.</span></div>
                            <div class="cat-box" onclick="yetenekKategoriAc('Tek Ses Tekrarƒ± Sorularƒ±')"><span class="cat-title" data-lang="cat_single_tone">Tek Ses Tekrarƒ± Sorularƒ±</span><span class="cat-desc" data-lang="desc_single_tone">Tek ses duyma √ßalƒ±≈ümalarƒ±.</span></div>
                            <div class="cat-box" onclick="yetenekKategoriAc('√áift Ses Tekrarƒ± Sorularƒ±')"><span class="cat-title" data-lang="cat_double_tone">√áift Ses Tekrarƒ± Sorularƒ±</span><span class="cat-desc" data-lang="desc_double_tone">ƒ∞ki ses duyma √ßalƒ±≈ümalarƒ±.</span></div>
                            <div class="cat-box" onclick="yetenekKategoriAc('√ú√ß Ses Tekrarƒ± Sorularƒ±')"><span class="cat-title" data-lang="cat_triad">√ú√ß Ses Tekrarƒ± Sorularƒ±</span><span class="cat-desc" data-lang="desc_triad">Akor duyma √ßalƒ±≈ümalarƒ±.</span></div>
                            <div class="cat-box" onclick="yetenekKategoriAc('D√∂rt Ses Tekrarƒ± Sorularƒ±')"><span class="cat-title" data-lang="cat_quad">D√∂rt Ses Tekrarƒ± Sorularƒ±</span><span class="cat-desc" data-lang="desc_quad">ƒ∞leri seviye akor √ßalƒ±≈ümalarƒ±.</span></div>
                            <div class="cat-box" onclick="yetenekKategoriAc('Solfej Notalarƒ±')"><span class="cat-title" data-lang="cat_solfege">Solfej Notalarƒ±</span><span class="cat-desc" data-lang="desc_solfege">De≈üifre ve okuma.</span></div>
                            <div class="cat-box" onclick="yetenekKategoriAc('Ezgi Tekrarƒ± Sorularƒ±')"><span class="cat-title" data-lang="cat_melody">Ezgi Tekrarƒ± Sorularƒ±</span><span class="cat-desc" data-lang="desc_melody">Melodik hafƒ±za √ßalƒ±≈ümalarƒ±.</span></div>
                        </div>
                    </div>

                    <div id="exam-list-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 id="exam-list-title">√áalƒ±≈ümalar</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem;" data-lang="btn_back">‚Üê Geri</button>
                        </div>
                        <br>
                        <div id="exam-list-container" style="display: flex; flex-direction: column; gap: 10px;">
                            </div>
                    </div>

                    <div id="exam-detail-view" class="view-section">
                        <div class="dashboard-header" style="display: flex; justify-content: space-between;">
                            <h2 id="exam-detail-title">√áalƒ±≈üma X</h2>
                            <button onclick="window.history.back()" style="background:none; border:none; color:#888; cursor:pointer; font-size: 1rem;" data-lang="btn_back_list">‚Üê Listeye D√∂n</button>
                        </div>
                        <div class="exam-detail-container">
                            <p style="color:#888; margin-bottom:15px;" data-lang="listen_dictation">üéß Dikte Kaydƒ±nƒ± Dinle:</p>
                            <iframe id="exam-audio-player" src="" width="100%" height="150" style="border:none; border-radius: 10px;" allow="autoplay"></iframe>
                            
                            <div class="answer-key-btn" onclick="cevapGoster()">
                                <i class="fas fa-eye"></i> <span data-lang="view_answer">CEVAP ANAHTARINI G√ñR√úNT√úLE</span>
                            </div>
                            <input type="hidden" id="current-answer-img" value="">
                        </div>
                    </div>

                </div>
            </div>
        </div>

    </div>

    <div class="image-modal" id="imgModal">
        <span class="close-modal" onclick="modalKapat()">√ó</span>
        <img id="modalImg" src="" alt="Cevap Anahtarƒ±">
    </div>

    <footer>
        <div class="social-wrapper">
            <a href="https://www.instagram.com/baglamagram" target="_blank" class="social-item"><i class="fab fa-instagram"></i></a>
            <a href="https://open.spotify.com/intl-tr/artist/5rXy7D9yXqn3kOvLYXDxft" target="_blank" class="social-item"><i class="fab fa-spotify"></i></a>
            <a href="https://www.youtube.com/@baglamagram" target="_blank" class="social-item"><i class="fab fa-youtube"></i></a>
        </div>
        <p style="font-size: 0.8rem; color: #555;" data-lang="footer_rights">¬© 2026 Mahmut Burak ASLANTA≈û.</p>
    </footer>

   <script>
        // --- Dƒ∞L & √áEVƒ∞Rƒ∞ Sƒ∞STEMƒ∞ ---
        const translations = {
            tr: {
                menu_home: "ANA SAYFA", menu_about: "HAKKINDA", menu_edu: "ONLINE Eƒûƒ∞Tƒ∞M", menu_notes: "NOTALAR", menu_poems: "≈ûƒ∞ƒ∞RLER", menu_concerts: "KONSERLER",
                portal_title: "√ñƒûRENCƒ∞ PORTALI", ph_email: "E-posta Adresiniz", ph_pass: "≈ûifreniz", forgot_pass: "≈ûifremi Unuttum", btn_login: "Gƒ∞Rƒ∞≈û YAP",
                btn_enter_portal: "√ñƒûRENCƒ∞ PORTALINA Gƒ∞Rƒ∞≈û YAP", public_h2: "Neden Online Eƒüitim?",
                feat_ai_title: "Yapay Zeka ile Eƒüitim", feat_ai_desc: "Yapay zeka destekli m√ºzik √∂ƒüretmeniniz BurakAI ile eƒüitimde yeni bir d√∂nem. Bu teknolojiyi kullanmak ve derslerinize entegre etmek i√ßin a≈üaƒüƒ±daki formu doldurarak ders paketlerimizi satƒ±n alabilirsiniz.",
                feat_time_title: "Mesai Sonrasƒ± Sanat", feat_time_desc: "√áoƒüu kurs ak≈üam 19:00'da kapƒ±larƒ±nƒ± kapatƒ±r. Biz ise tam o saatlerde ba≈ülƒ±yoruz. ƒ∞≈üten eve d√∂nd√ºƒü√ºn√ºzde, trafiƒüe girmeden ve kurs saatlerine yeti≈üme stresi ya≈üamadan baƒülamanƒ±zƒ± elinize alƒ±n.",
                feat_premium_title: "Premium √ñƒürenci Portalƒ±", feat_premium_desc: "Bu b√∂l√ºmde, yalnƒ±zca kendinize √∂zel verilen ≈üifre ile eri≈üebileceƒüiniz ders materyalleri yer almaktadƒ±r. T√ºm i√ßerikler, √∂ƒürenme s√ºrecini desteklemek amacƒ±yla sesli ve g√∂rsel materyallerle hazƒ±rlanmƒ±≈ütƒ±r. Materyaller d√ºzenli olarak g√ºncellenmekte ve seviyelere g√∂re yapƒ±landƒ±rƒ±lmaktadƒ±r.",
                feat_comm_title: "Kesintisiz ƒ∞leti≈üim", feat_comm_desc: "Ders bittiƒüinde baƒüƒ±mƒ±z kopmaz, Dilediƒüiniz zaman WhatsApp √ºzerinden √∂devlerinizi g√∂nderip, kafanƒ±za takƒ±lan sorularƒ± sorup, videolarƒ±nƒ±zƒ± g√∂nderebilirsiniz. Bu √∂zelliƒüe sadece √∂ƒürenci portalƒ± √ºzerinden eri≈üim saƒülayabilirsiniz.",
                apply_title: "BA≈ûVURU FORMU", ph_name: "Ad Soyad", ph_phone: "Telefon Numaranƒ±z", ph_age: "Ya≈ü (16+)", ph_job: "Meslek (Opsiyonel)", ph_level: "Mevcut Seviyeniz",
                level_0: "Hi√ß Bilmiyorum", level_1: "Temel Seviye", level_2: "ƒ∞leri Seviye", ph_goals: "M√ºzikal hedefleriniz...", btn_send: "G√ñNDER",
                badge_premium: "PREMIUM √úYE", sb_home: "Ana Sayfa", sb_edu_title: "Eƒûƒ∞Tƒ∞MLERƒ∞M", sb_baglama: "Baƒülama Eƒüitimi", sb_exam: "Yetenek Sƒ±navƒ± Hazƒ±rlƒ±k",
                sb_tools_title: "ARA√áLAR", sb_metro: "Metronom", sb_tuner: "Akort Cihazƒ±", sb_live: "Canlƒ± Ders", sb_ai: "BurakAI Hoca (beta)", sb_emergency: "Acil Durumlar ƒ∞√ßin",
                card_baglama_title: "BAƒûLAMA Eƒûƒ∞Tƒ∞Mƒ∞", card_baglama_desc: "Ders notlarƒ±, notalar ve egzersizleri.",
                card_ai_title: "BurakAI Hoca (beta)", badge_new: "YENƒ∞", card_ai_desc1: "Yapay Zeka Entegrasyonlu ƒ∞lk M√ºzik Eƒüitim Platformu.", card_ai_desc2: "7/24 Emrinizdeyim. T√ºrkiye'de Bir ƒ∞lk!",
                card_exam_title: "YETENEK SINAVINA HAZIRLIK", card_exam_desc: "Konservatuvar, M√ºzik √∂ƒüretmenliƒüi ve GSL'ye hazƒ±rlƒ±k i√ßin √∂ƒüretim materyalleri.",
                card_live_title: "CANLI DERS", card_live_desc: "Sanal sƒ±nƒ±fa baƒülanarak canlƒ± derse katƒ±lƒ±n.",
                ai_header: "BurakAI Hoca", btn_back: "‚Üê Geri", btn_back_list: "‚Üê Listeye D√∂n", ai_intro: "Kafana takƒ±lan her ≈üeyi sorabilirsin, ben senin i√ßin burdayƒ±m ciƒüerim.",
                ai_welcome_msg: "Gel bakalƒ±m evladƒ±m, ho≈ü geldin. Sazƒ±n kucaƒüƒ±ndaysa, g√∂nl√ºn de a≈üka hazƒ±rsa a≈üamayacaƒüƒ±mƒ±z yoku≈ü yok. 'Yorulduk' demek yok, 'yapamƒ±yorum' demek yok. Ben senin her adƒ±mda yanƒ±ndayƒ±m. Hadi bismillah diyelim, sor bakalƒ±m kafana takƒ±lan ≈üey nedir?",
                btn_remove: "Kaldƒ±r", ph_chat: "Bir soru sor...", metro_title: "Metronom", btn_start: "BA≈ûLAT", btn_stop: "DURDUR",
                tuner_title: "Akort Cihazƒ±", tuner_instr: "Ba≈ülamak i√ßin butona bas ve teline vur.", btn_tuner_start: "AKORTU BA≈ûLAT", btn_tuner_stop: "DURDUR",
                short_neck: "KISA SAP", long_neck: "UZUN SAP", live_title: "Sanal Sƒ±nƒ±f",
                baglama_edu_title: "Baƒülama Eƒüitimi", cat_theory: "Ders Notlarƒ± (Teorik Bilgi)", desc_theory: "M√ºzik teorisi ve makamlar.",
                cat_short: "Kƒ±sa Sap T√ºrk√º Notalarƒ±", desc_short: "Kƒ±sa sap repertuvarƒ±.", cat_long: "Uzun Sap T√ºrk√º Notalarƒ±", desc_long: "Uzun sap icra teknikleri.",
                cat_ex: "Parmak Egzersizleri", desc_ex: "Hƒ±z ve teknik geli≈ütirici et√ºtler.",
                exam_prep_title: "Yetenek Sƒ±navƒ± Hazƒ±rlƒ±k", cat_dictation: "Dikte Sorularƒ±", desc_dictation: "ƒ∞≈üitme ve yazma √ßalƒ±≈ümalarƒ±.",
                cat_rhythm: "Ritim Tekrarƒ± Sorularƒ±", desc_rhythm: "Ritim kulaƒüƒ±nƒ± geli≈ütirme.", cat_single_tone: "Tek Ses Tekrarƒ± Sorularƒ±", desc_single_tone: "Tek ses duyma √ßalƒ±≈ümalarƒ±.",
                cat_double_tone: "√áift Ses Tekrarƒ± Sorularƒ±", desc_double_tone: "ƒ∞ki ses duyma √ßalƒ±≈ümalarƒ±.", cat_triad: "√ú√ß Ses Tekrarƒ± Sorularƒ±", desc_triad: "Akor duyma √ßalƒ±≈ümalarƒ±.",
                cat_quad: "D√∂rt Ses Tekrarƒ± Sorularƒ±", desc_quad: "ƒ∞leri seviye akor √ßalƒ±≈ümalarƒ±.", cat_solfege: "Solfej Notalarƒ±", desc_solfege: "De≈üifre ve okuma.",
                cat_melody: "Ezgi Tekrarƒ± Sorularƒ±", desc_melody: "Melodik hafƒ±za √ßalƒ±≈ümalarƒ±.",
                listen_dictation: "üéß Dikte Kaydƒ±nƒ± Dinle:", view_answer: "CEVAP ANAHTARINI G√ñR√úNT√úLE", footer_rights: "¬© 2026 Mahmut Burak ASLANTA≈û.",
                
                // JS ƒ∞√ßin Dinamik Metinler
                alert_video: "Video √∂zelliƒüi yakƒ±nda gelecek aslan par√ßasƒ±. ≈ûimdilik fotoƒüraf g√∂nderebilirsin.",
                js_tuner_stopped: "Akort cihazƒ± durduruldu.", js_tuner_listening: "Mikrofon dinleniyor...",
                js_login_empty: "L√ºtfen √∂nce yukarƒ±ya e-posta adresini yaz.", js_reset_sending: "Sƒ±fƒ±rlama baƒülantƒ±sƒ± g√∂nderiliyor...", js_reset_sent: "E-postanƒ± kontrol et! Sƒ±fƒ±rlama linki g√∂nderildi.",
                js_user_not_found: "Bu e-posta adresi kayƒ±tlƒ± deƒüil.", js_invalid_email: "Ge√ßersiz e-posta formatƒ±.", js_check_info: "Bilgiler kontrol ediliyor...",
                js_login_success: "Giri≈ü Ba≈üarƒ±lƒ±! Y√∂nlendiriliyorsun...", js_welcome: "Ho≈ü Geldin, ", js_student: "√ñƒûRENCƒ∞", js_login_error: "E-posta veya ≈üifre hatalƒ±!",
                js_error: "Hata olu≈ütu.", js_no_material: "Bu kategoride hen√ºz materyal bulunmuyor.", js_no_content: "Bu kategoride hen√ºz i√ßerik yok.", js_exercise: "√áalƒ±≈üma",
                js_no_answer: "Cevap anahtarƒ± bulunamadƒ±.", js_mic_error: "Mikrofon eri≈üim hatasƒ±! L√ºtfen izin verin.", js_ai_typing: "<em>Burak Hoca inceliyor... (Yazƒ±yor)</em>",
                js_ai_error: "Aƒü Hatasƒ± (ƒ∞nternetini kontrol et): "
            },
            en: {
                menu_home: "HOME", menu_about: "ABOUT ME", menu_edu: "ONLINE LESSONS", menu_notes: "SHEET MUSIC", menu_poems: "POEMS", menu_concerts: "CONCERTS",
                portal_title: "STUDENT PORTAL", ph_email: "Your Email Address", ph_pass: "Your Password", forgot_pass: "Forgot Password", btn_login: "LOGIN",
                btn_enter_portal: "ENTER STUDENT PORTAL", public_h2: "Why Online Education?",
                feat_ai_title: "AI-Powered Education", feat_ai_desc: "A new era in education with your AI-supported music teacher BurakAI. To use this technology and integrate it into your lessons, please fill out the form below to purchase our lesson packages.",
                feat_time_title: "Art After Work", feat_time_desc: "Most courses close their doors at 19:00. We start exactly at those hours. Pick up your baglama when you return home from work, without getting into traffic and without the stress of catching up with course hours.",
                feat_premium_title: "Premium Student Portal", feat_premium_desc: "In this section, there are course materials that you can access only with the password given specifically to you. All contents are prepared with audio and visual materials to support the learning process. Materials are regularly updated and structured according to levels.",
                feat_comm_title: "Continuous Communication", feat_comm_desc: "Our bond does not break when the lesson ends. You can send your homework via WhatsApp, ask questions, and send your videos whenever you want. You can only access this feature through the student portal.",
                apply_title: "APPLICATION FORM", ph_name: "Full Name", ph_phone: "Phone Number", ph_age: "Age (16+)", ph_job: "Profession (Optional)", ph_level: "Current Level",
                level_0: "Total Beginner", level_1: "Basic Level", level_2: "Advanced Level", ph_goals: "Your musical goals...", btn_send: "SEND",
                badge_premium: "PREMIUM MEMBER", sb_home: "Dashboard", sb_edu_title: "MY COURSES", sb_baglama: "Baglama Training", sb_exam: "Talent Exam Prep",
                sb_tools_title: "TOOLS", sb_metro: "Metronome", sb_tuner: "Tuner", sb_live: "Live Class", sb_ai: "BurakAI Mentor (beta)", sb_emergency: "Emergency Contact",
                card_baglama_title: "BAGLAMA TRAINING", card_baglama_desc: "Lecture notes, sheet music, and exercises.",
                card_ai_title: "BurakAI Mentor (beta)", badge_new: "NEW", card_ai_desc1: "First AI Integrated Music Education Platform.", card_ai_desc2: "At your service 24/7. A first in Turkey!",
                card_exam_title: "TALENT EXAM PREP", card_exam_desc: "Teaching materials for Conservatory, Music Teaching, and Fine Arts High School preparation.",
                card_live_title: "LIVE CLASS", card_live_desc: "Join the live lesson by connecting to the virtual classroom.",
                ai_header: "BurakAI Mentor", btn_back: "‚Üê Back", btn_back_list: "‚Üê Back to List", ai_intro: "You can ask me anything you're wondering about, I'm here for you.",
                ai_welcome_msg: "Welcome, my child. If your instrument is in your lap and your heart is ready for love, there is no hill we cannot climb. No saying 'I'm tired', no saying 'I can't'. I am with you every step of the way. Let's start, ask me what's on your mind?",
                btn_remove: "Remove", ph_chat: "Ask a question...", metro_title: "Metronome", btn_start: "START", btn_stop: "STOP",
                tuner_title: "Instrument Tuner", tuner_instr: "Press the button and pluck your string to start.", btn_tuner_start: "START TUNER", btn_tuner_stop: "STOP",
                short_neck: "SHORT NECK", long_neck: "LONG NECK", live_title: "Virtual Classroom",
                baglama_edu_title: "Baglama Training", cat_theory: "Lecture Notes (Theory)", desc_theory: "Music theory and scales.",
                cat_short: "Short Neck Folk Songs", desc_short: "Short neck repertoire.", cat_long: "Long Neck Folk Songs", desc_long: "Long neck performance techniques.",
                cat_ex: "Finger Exercises", desc_ex: "Speed and technique development etudes.",
                exam_prep_title: "Talent Exam Preparation", cat_dictation: "Dictation Questions", desc_dictation: "Hearing and writing exercises.",
                cat_rhythm: "Rhythm Repetition", desc_rhythm: "Developing rhythmic ear.", cat_single_tone: "Single Tone Repetition", desc_single_tone: "Hearing single tones.",
                cat_double_tone: "Double Tone Repetition", desc_double_tone: "Hearing two tones.", cat_triad: "Triad Repetition", desc_triad: "Hearing chords.",
                cat_quad: "Quadrad Repetition", desc_quad: "Advanced chord exercises.", cat_solfege: "Solfege Notes", desc_solfege: "Sight-reading.",
                cat_melody: "Melody Repetition", desc_melody: "Melodic memory exercises.",
                listen_dictation: "üéß Listen to Dictation:", view_answer: "VIEW ANSWER KEY", footer_rights: "¬© 2026 Mahmut Burak ASLANTA≈û. All Rights Reserved.",
                
                // JS Dynamic Texts
                alert_video: "Video feature coming soon, champ. You can send photos for now.",
                js_tuner_stopped: "Tuner stopped.", js_tuner_listening: "Listening to microphone...",
                js_login_empty: "Please enter your email address above first.", js_reset_sending: "Sending reset link...", js_reset_sent: "Check your email! Reset link sent.",
                js_user_not_found: "This email address is not registered.", js_invalid_email: "Invalid email format.", js_check_info: "Checking information...",
                js_login_success: "Login Successful! Redirecting...", js_welcome: "Welcome, ", js_student: "STUDENT", js_login_error: "Incorrect email or password!",
                js_error: "An error occurred.", js_no_material: "No materials available in this category yet.", js_no_content: "No content available in this category yet.", js_exercise: "Exercise",
                js_no_answer: "Answer key not found.", js_mic_error: "Microphone access error! Please allow access.", js_ai_typing: "<em>BurakAI is analyzing... (Typing)</em>",
                js_ai_error: "Network Error (Check your internet): "
            }
        };

        let currentLang = localStorage.getItem("selectedLang") || "tr";
        
        function t(key) {
            return translations[currentLang][key] || key;
        }

        function toggleLanguageMenu() {
            document.getElementById("langDropdown").classList.toggle("active");
        }

        function changeLanguage(lang) {
            currentLang = lang;
            localStorage.setItem("selectedLang", lang);
            document.getElementById("langDropdown").classList.remove("active");
            
            // 1. Static HTML Elements
            document.querySelectorAll("[data-lang]").forEach(el => {
                const key = el.getAttribute("data-lang");
                if(translations[lang][key]) el.innerHTML = translations[lang][key]; // innerHTML for <strong> tags
            });

            // 2. Placeholders
            document.querySelectorAll("[data-lang-placeholder]").forEach(el => {
                const key = el.getAttribute("data-lang-placeholder");
                if(translations[lang][key]) el.placeholder = translations[lang][key];
            });

            // 3. Dynamic Button States (Metronome/Tuner)
            const tunerBtn = document.getElementById("tunerBtn");
            const playBtn = document.getElementById("playBtn");
            if(tunerBtn) {
                 // Check if running to keep correct state text
                 if(tunerBtn.classList.contains('tuner-btn-active')) {
                     tunerBtn.innerHTML = `<i class="fas fa-stop"></i> ${t("btn_tuner_stop")}`;
                     document.getElementById("tunerStatus").innerText = t("js_tuner_listening");
                 } else {
                     tunerBtn.innerHTML = `<i class="fas fa-microphone"></i> ${t("btn_tuner_start")}`;
                     // If purely stopped, text handled by toggle function but initial state needs update
                 }
            }
            if(playBtn) {
                if(playBtn.classList.contains('playing')) {
                    playBtn.innerHTML = `<i class="fas fa-stop"></i> ${t("btn_stop")}`;
                } else {
                    playBtn.innerHTML = `<i class="fas fa-play"></i> ${t("btn_start")}`;
                }
            }
        }

        // Initialize Language
        document.addEventListener("DOMContentLoaded", () => {
             if(currentLang === 'en') changeLanguage('en');
        });

        // --- 1. Dƒ∞KTE SES DOSYALARI ---
        const dikteVerileri = {
            1: "1CprU3vYtFIEZ0gRgReVEye4IHShh0y0_",
            2: "1F47H-u9OgakbY-Y8o0X3s_ago7C9x-RO",
            3: "1l11yz8LBCdNAVkA4dJDF_YefA4m62PxH",
            4: "1h_BxQSVd1saDgertInDrXgbU7p8kPdrT",
            5: "16zIsIzjvmznslqO4xi8LtvSE0H3UgEDf",
            6: "1cXuv3Qe-WgDNGP4tCgyDyHTrZAhmWiEK",
            7: "1ShwDrGKN0r1Q5WMrz1saX_KYFPDx1RdV",
            8: "1uyYxuJmbniDOLy5k9_C7ZcGI1yTwvdgx",
            9: "18RLPOB99gTjDZGqbPmanEIQ-nKFxIoa9",
            10: "1oMr4u1WJLiFxLLbMzAP3_40umU_Y3vq8",
            11: "1LyrE3Yi_xECEqIlwCP3-3FsrVtDBqjFs",
            12: "1fXUzZE1pIa-m1XtgD7giY-uiikdknZbc",
            13: "1TF_rBm31Ww8AszjQud4OCQP7SvWG2UK-",
            14: "12ckOq7FvW_tAIteDVxs11hNwpXw1mGmE",
            15: "1u0Gcj0M_Et5vXtBC1VUJeSJdg7VsqMCu",
            16: "1og4IiBkpgsxz2-zZF0TWCRRncWoW8eOB",
            17: "1qsJ-nLKY4V0-jQLoMxLxFOeVfD1u7rfg",
            19: "137H1eOM8qQoWZPDPi0QHyyKaiAbjMR1Q",
            20: "1327Yis-EDSEvKPxZu-H5wSA3mUC5IEXC",
            21: "1Ydo02tIquSSqO-cuF5fJ5jVBuI-X3rLj",
            22: "1pdHx7gHYkg1sEfu01AfVTxbpHQJ3GCOS"
        };

        // --- 2. DERS NOTLARI Lƒ∞STESƒ∞ ---
        const dersNotlariDosyalari = [
            { ad: "Temel M√ºzik Bilgileri 1", dosya: "1.png" },
            { ad: "Temel M√ºzik Bilgileri 2", dosya: "2.png" },
            { ad: "Nota S√ºre Deƒüerleri 1", dosya: "3.png" },
            { ad: "Nota ƒ∞simleri ve Notalarƒ±n Yerleri", dosya: "4.png" },
            { ad: "Baƒülamanƒ±n B√∂l√ºmleri", dosya: "5.png" },
            { ad: "Ders Notu 6", dosya: "6.png" },
            { ad: "Parmak Numaralarƒ± (Kƒ±sa Sap)", dosya: "7.png" },
            { ad: "Klavyede (Sapta) Notalarƒ±n Yerleri", dosya: "8.png" },
            { ad: "Sesli ve Sessiz S√ºre Deƒüerleri", dosya: "9.png" },
            { ad: "Nota S√ºreleri", dosya: "nota-sureleri.png" },
            { ad: "Nota S√ºreleri 2", dosya: "nota-sureleri1.png" }
        ];

        // --- 3. KISA SAP NOTALARI ---
        const kisaSapNotalari = [
            { ad: "Gelin Ay≈üem", dosya: "a.jpg" },
            { ad: "Eklemedir Koca Konak", dosya: "b.jpg" },
            { ad: "Urfa'nƒ±n Etrafƒ±", dosya: "c.jpg" },
            { ad: "Ye≈üil Ba≈ülƒ± Telli Turnam", dosya: "d.jpg" },
            { ad: "Karahisar Kalesi", dosya: "e.jpg" },
            { ad: "Urfa'nƒ±n Etrafƒ± Dumanlƒ± Daƒülar", dosya: "f.jpg" },
            { ad: "Uzun ƒ∞nce Bir Yoldayƒ±m", dosya: "g.jpg" },
            { ad: "ƒ∞≈üte Gidiyorum √áe≈üm-i Siyahƒ±m", dosya: "h.jpg" },
            { ad: "Basit T√ºrk√ºler", dosya: "i.jpg" },
            { ad: "Felek √áakmaƒüƒ±nƒ± √úst√ºme √áaktƒ±", dosya: "j.jpg" },
            { ad: "Telli Turnam", dosya: "k.jpg" },
            { ad: "Emirim Suya Gider", dosya: "l.jpg" },
            { ad: "Denizlerin Kumuyum", dosya: "m.jpg" },
            { ad: "Aynalƒ± K√∂r√ºk", dosya: "n.jpg" },
            { ad: "Deƒümen Benim Gamlƒ± Yaslƒ± G√∂nl√ºme", dosya: "o.jpg" },
            { ad: "Denizin Dibinde Hat√ßam", dosya: "p.jpg" },
            { ad: "K√ºtahyanƒ±n Pƒ±narlarƒ±", dosya: "r.jpg" },
            { ad: "Dostum Dostum", dosya: "s.png?v=1" }, 
            { ad: "Han Sarho≈ü Hancƒ± Sarho≈ü", dosya: "t.jpg" },
            { ad: "Altƒ±n Y√ºz√ºƒü√ºm Kƒ±rƒ±ldƒ±", dosya: "u.jpg" }
        ];

        // --- 4. PARMAK EGZERSƒ∞ZLERƒ∞ ---
        const parmakEgzersizleri = [
            { ad: "Alƒ±≈ütƒ±rma 1", dosya: "alistirma-1.png" },
            { ad: "Alƒ±≈ütƒ±rma 2", dosya: "alistirma-2.png" },
            { ad: "4 Parmak Et√ºd√º 1", dosya: "4-parmak-etutdu1.png" },
            { ad: "4 Parmak Et√ºd√º 2", dosya: "4-parmak-etudu2.png" }
        ];

        function menuyuAcKapa() { document.getElementById("anaMenu").classList.toggle("aktif"); }
        function toggleSidebar() { document.getElementById("sidebar").classList.toggle("collapsed"); }
        function girisAc() { document.getElementById("login-overlay").style.display = "flex"; }
        function girisKapat() { document.getElementById("login-overlay").style.display = "none"; }

        function sayfaGoster(id, addToHistory = true) {
            document.querySelectorAll(".view-section").forEach(s => s.classList.remove("active"));
            document.getElementById(id).classList.add("active");
            if(addToHistory) history.pushState({view: id}, "", "#" + id.replace("-view", ""));
            if(window.innerWidth < 900) { document.getElementById("sidebar").classList.add("collapsed"); }
        }

        window.onpopstate = function(event) {
            if(event.state && event.state.view) sayfaGoster(event.state.view, false);
            else sayfaGoster('dashboard-view', false);
        };

        // Translate Dynamic Item Names
        function getTranslatedItemName(name) {
            if(currentLang === 'tr') return name;
            // Basic mapping for generic terms
            if(name.startsWith("Alƒ±≈ütƒ±rma")) return name.replace("Alƒ±≈ütƒ±rma", "Exercise");
            if(name.startsWith("4 Parmak Et√ºd√º")) return name.replace("4 Parmak Et√ºd√º", "4 Finger Etude");
            if(name.startsWith("Temel M√ºzik Bilgileri")) return name.replace("Temel M√ºzik Bilgileri", "Basic Music Theory");
            if(name.startsWith("Nota S√ºre")) return name.replace("Nota S√ºre", "Note Duration");
            if(name.startsWith("Ders Notu")) return name.replace("Ders Notu", "Lecture Note");
            if(name === "Baƒülamanƒ±n B√∂l√ºmleri") return "Parts of Baglama";
            if(name === "Parmak Numaralarƒ± (Kƒ±sa Sap)") return "Finger Numbers (Short Neck)";
            if(name === "Klavyede (Sapta) Notalarƒ±n Yerleri") return "Note Positions on Neck";
            if(name === "Basit T√ºrk√ºler") return "Simple Folk Songs";
            return name; // Return proper nouns as is
        }

        // Translate Category Title Logic
        const categoryMap = {
            'Teorik Bilgi': 'cat_theory',
            'Kƒ±sa Sap Notalarƒ±': 'cat_short',
            'Uzun Sap Notalarƒ±': 'cat_long',
            'Parmak Egzersizleri': 'cat_ex',
            'Dikte Sorularƒ±': 'cat_dictation',
            'Ritim Tekrarƒ± Sorularƒ±': 'cat_rhythm',
            'Tek Ses Tekrarƒ± Sorularƒ±': 'cat_single_tone',
            '√áift Ses Tekrarƒ± Sorularƒ±': 'cat_double_tone',
            '√ú√ß Ses Tekrarƒ± Sorularƒ±': 'cat_triad',
            'D√∂rt Ses Tekrarƒ± Sorularƒ±': 'cat_quad',
            'Solfej Notalarƒ±': 'cat_solfege',
            'Ezgi Tekrarƒ± Sorularƒ±': 'cat_melody'
        };

        function materyalAc(kategori) {
            // Translate header
            document.getElementById("mat-category-title").innerText = t(categoryMap[kategori] || 'materials');
            
            const container = document.getElementById("materials-container");
            container.innerHTML = ""; 

            if (kategori === 'Teorik Bilgi') {
                dersNotlariDosyalari.forEach(item => {
                    container.innerHTML += `<div class="mat-item" onclick="resimGosterModal('./baglama-ders-teori/${item.dosya}')" style="cursor:pointer;"><i class="fas fa-file-image" style="color: var(--yellow-portal); font-size: 2rem; display: block; margin-bottom: 10px;"></i><span>${getTranslatedItemName(item.ad)}</span></div>`;
                });
            } else if (kategori === 'Kƒ±sa Sap Notalarƒ±') {
                kisaSapNotalari.forEach(item => {
                    container.innerHTML += `<div class="mat-item" onclick="resimGosterModal('./kisa-sap/${item.dosya}')" style="cursor:pointer;"><i class="fas fa-music" style="color: var(--yellow-portal); font-size: 2rem; display: block; margin-bottom: 10px;"></i><span>${getTranslatedItemName(item.ad)}</span></div>`;
                });
            } else if (kategori === 'Parmak Egzersizleri') {
                parmakEgzersizleri.forEach(item => {
                    container.innerHTML += `<div class="mat-item" onclick="resimGosterModal('./parmak-egzersiz/${item.dosya}')" style="cursor:pointer;"><i class="fas fa-hand-paper" style="color: var(--yellow-portal); font-size: 2rem; display: block; margin-bottom: 10px;"></i><span>${getTranslatedItemName(item.ad)}</span></div>`;
                });
            } else {
                container.innerHTML = `<p style='color:#888; padding: 20px;'>${t('js_no_material')}</p>`;
            }
            sayfaGoster("materials-view");
        }

        function yetenekKategoriAc(kategoriAdi) {
            document.getElementById("exam-list-title").innerText = t(categoryMap[kategoriAdi] || 'exam_prep');
            const listeContainer = document.getElementById("exam-list-container");
            listeContainer.innerHTML = "";
            if (kategoriAdi === "Dikte Sorularƒ±") {
                for (let i = 1; i <= 22; i++) {
                    if (i === 18) continue;
                    let driveId = dikteVerileri[i] || ""; 
                    listeContainer.innerHTML += `<div class="exam-row" onclick="dikteDetayAc(${i}, '${driveId}', '${t("js_exercise")} ${i}')"><span style="color:#fff; font-weight:500;">${t("js_exercise")} ${i}</span><i class="fas fa-chevron-right" style="color:var(--yellow-portal);"></i></div>`;
                }
            } else {
                listeContainer.innerHTML = `<p style='color:#888;'>${t('js_no_content')}</p>`;
            }
            sayfaGoster("exam-list-view");
        }

        function dikteDetayAc(no, audioId, baslik) {
            document.getElementById("exam-detail-title").innerText = baslik;
            let embedUrl = audioId ? "https://drive.google.com/file/d/" + audioId + "/preview" : "";
            document.getElementById("exam-audio-player").src = embedUrl;
            document.getElementById("current-answer-img").value = "./dikte-cevaplar/calisma-" + no + ".png"; 
            sayfaGoster("exam-detail-view");
        }

        function resimGosterModal(yol) {
            document.getElementById("modalImg").src = yol;
            document.getElementById("imgModal").style.display = "flex";
        }

        function cevapGoster() {
            const link = document.getElementById("current-answer-img").value;
            if(link) {
                resimGosterModal(link);
            } else {
                alert(t("js_no_answer"));
            }
        }
        function modalKapat() { document.getElementById("imgModal").style.display = "none"; }
        function alertVideoFeature() { alert(t("alert_video")); }

        function startLiveClass() {
            const domain = 'meet.jit.si';
            const options = {
                roomName: 'BurakHocaBaglamaSinifi',
                width: '100%',
                height: 600,
                parentNode: document.querySelector('#meet-frame'),
                lang: currentLang, // Set Jitsi lang based on current lang
                configOverwrite: { 
                    startWithAudioMuted: true,
                    prejoinPageEnabled: false
                }
            };
            
            if(document.querySelector('#meet-frame').innerHTML === "") {
                const api = new JitsiMeetExternalAPI(domain, options);
            }
            
            sayfaGoster('live-class-view');
        }

        // --- PROFƒ∞L FOTOƒûRAFI Y√úKLEME ---
        function saveProfilePhoto(input) {
            if (input.files && input.files[0]) {
                const file = input.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        const MAX_SIZE = 300; 
                        let width = img.width;
                        let height = img.height;
                        
                        if (width > height) {
                            if (width > MAX_SIZE) {
                                height *= MAX_SIZE / width;
                                width = MAX_SIZE;
                            }
                        } else {
                            if (height > MAX_SIZE) {
                                width *= MAX_SIZE / height;
                                height = MAX_SIZE;
                            }
                        }
                        canvas.width = width;
                        canvas.height = height;
                        
                        ctx.drawImage(img, 0, 0, width, height);
                        const dataUrl = canvas.toDataURL('image/jpeg', 0.7); 
                        
                        document.getElementById('userAvatar').src = dataUrl;
                        
                        // Kƒ∞≈ûƒ∞YE √ñZEL KAYDETME
                        const aktifMail = localStorage.getItem('aktifKullaniciMail');
                        if (aktifMail) {
                            localStorage.setItem('foto_' + aktifMail, dataUrl);
                        } else {
                            localStorage.setItem('geciciFoto', dataUrl);
                        }
                    };
                    img.src = e.target.result;
                }
                reader.readAsDataURL(file);
            }
        }

        // --- CHAT VE BURAKAI ---
        let selectedImageBase64 = null;
        let lastAiResponse = "";

        function metniSeslendir(htmlMetin) {
            let temizMetin = htmlMetin.replace(/<[^>]*>?/gm, ''); 
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel(); 
                let ses = new SpeechSynthesisUtterance(temizMetin);
                ses.lang = (currentLang === 'en') ? 'en-US' : 'tr-TR';
                ses.rate = 1.0; 
                window.speechSynthesis.speak(ses);
            }
        }

        function toggleSpeech() {
            if (window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
            } else if (lastAiResponse) {
                metniSeslendir(lastAiResponse);
            }
        }

        function triggerFileUpload() {
            document.getElementById('fileInput').click();
        }

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    
                    const MAX_WIDTH = 800;
                    const MAX_HEIGHT = 800;
                    let width = img.width;
                    let height = img.height;

                    if (width > height) {
                        if (width > MAX_WIDTH) {
                            height *= MAX_WIDTH / width;
                            width = MAX_WIDTH;
                        }
                    } else {
                        if (height > MAX_HEIGHT) {
                            width *= MAX_HEIGHT / height;
                            height = MAX_HEIGHT;
                        }
                    }

                    canvas.width = width;
                    canvas.height = height;
                    ctx.drawImage(img, 0, 0, width, height);

                    selectedImageBase64 = canvas.toDataURL('image/jpeg', 0.7);

                    const imgPreview = document.getElementById('imagePreview');
                    imgPreview.src = selectedImageBase64;
                    document.getElementById('imagePreviewContainer').style.display = 'block';
                }
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });

        document.getElementById('removeImage').onclick = function() {
            selectedImageBase64 = null;
            document.getElementById('fileInput').value = "";
            document.getElementById('imagePreviewContainer').style.display = 'none';
        }

        // --- ENTER TU≈ûU ƒ∞LE MESAJ G√ñNDERME ---
        document.getElementById("aiUserInput").addEventListener("keypress", function(event) {
            if (event.key === "Enter") {
                event.preventDefault(); 
                sendMessage();
            }
        });

        async function sendMessage() {
            const input = document.getElementById("aiUserInput");
            const box = document.getElementById("aiChatBox");
            const msgText = input.value.trim();
            
            if(msgText === "" && !selectedImageBase64) return;

            const userMsg = document.createElement("div");
            userMsg.className = "chat-message user";
            
            let userContent = "";
            if (selectedImageBase64) {
                userContent += `<img src="${selectedImageBase64}" style="max-width:200px; display:block; margin-bottom:5px;">`;
            }
            if (msgText) {
                userContent += `<strong>Sen:</strong><br>${msgText}`;
            }
            userMsg.innerHTML = userContent;
            box.appendChild(userMsg);
            
            input.value = "";
            const imageToSend = selectedImageBase64;
            
            selectedImageBase64 = null;
            document.getElementById('fileInput').value = "";
            document.getElementById('imagePreviewContainer').style.display = 'none';
            
            box.scrollTop = box.scrollHeight;

            const loadingBubble = document.createElement("div");
            loadingBubble.className = "chat-message ai";
            loadingBubble.id = "loadingBubble";
            loadingBubble.innerHTML = t("js_ai_typing");
            box.appendChild(loadingBubble);
            box.scrollTop = box.scrollHeight;

            try {
                // Determine system prompt language based on user selection
                const systemLang = currentLang === 'en' ? 'en' : 'tr';
                
                const response = await fetch('https://baglamagram.vercel.app/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        message: msgText || "≈ûu g√∂nderdiƒüim g√∂rsele bir bak hocam.", 
                        image: imageToSend,
                        language: systemLang // Pass language to backend if backend supports it, otherwise prompt engineering needed
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.reply || errorData.error || `Sunucu Hatasƒ±: ${response.status}`);
                }

                const data = await response.json();
                document.getElementById("loadingBubble").remove();
                
                const aiMsg = document.createElement("div");
                aiMsg.className = "chat-message ai";
                
                if (data.reply && (data.reply.includes("HATA") || data.reply.includes("Hatasƒ±"))) {
                        aiMsg.style.color = "red";
                }
                
                lastAiResponse = data.reply;

                aiMsg.innerHTML = `<strong style='color: var(--accent); font-family: "Playfair Display", serif;'>BurakAI Hoca:</strong><br>` + (data.reply ? data.reply.replace(/\n/g, "<br>") : "Cevap bo≈ü geldi.");
                box.appendChild(aiMsg);

            } catch (err) {
                const bubble = document.getElementById("loadingBubble");
                if(bubble) bubble.innerHTML = t("js_ai_error") + err.message;
                console.error(err);
            }
            
            box.scrollTop = box.scrollHeight;
        }

        // --- METRONOM MANTIƒûI ---
        let audioCtx = null;
        let isPlaying = false;
        let tempo = 100;
        let currentBeat = 0;
        let nextNoteTime = 0.0;
        let timerID = null;
        let beatsPerMeasure = 4;
        const lookahead = 25.0; // ms
        const scheduleAheadTime = 0.1; // sn

        function nextNote() {
            const secondsPerBeat = 60.0 / tempo;
            nextNoteTime += secondsPerBeat;
            currentBeat++;
            if (currentBeat >= beatsPerMeasure) {
                currentBeat = 0;
            }
        }

        function scheduleNote(beatNumber, time) {
            setTimeout(() => {
                updateVisuals(beatNumber);
            }, (time - audioCtx.currentTime) * 1000);

            const osc = audioCtx.createOscillator();
            const envelope = audioCtx.createGain();

            osc.frequency.value = (beatNumber === 0) ? 1000 : 800;

            envelope.gain.value = 1;
            envelope.gain.exponentialRampToValueAtTime(1, time + 0.001);
            envelope.gain.exponentialRampToValueAtTime(0.001, time + 0.05);

            osc.connect(envelope);
            envelope.connect(audioCtx.destination);

            osc.start(time);
            osc.stop(time + 0.05);
        }

        function scheduler() {
            while (nextNoteTime < audioCtx.currentTime + scheduleAheadTime) {
                scheduleNote(currentBeat, nextNoteTime);
                nextNote();
            }
            timerID = setTimeout(scheduler, lookahead);
        }

        function toggleMetronome() {
            const btn = document.getElementById('playBtn');
            
            if (isPlaying) {
                isPlaying = false;
                clearTimeout(timerID);
                btn.innerHTML = `<i class="fas fa-play"></i> ${t("btn_start")}`;
                btn.classList.remove('playing');
                resetVisuals();
            } else {
                if (!audioCtx) {
                    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                }
                
                if(audioCtx.state === 'suspended') {
                    audioCtx.resume();
                }

                isPlaying = true;
                currentBeat = 0;
                nextNoteTime = audioCtx.currentTime + 0.05;
                scheduler();
                btn.innerHTML = `<i class="fas fa-stop"></i> ${t("btn_stop")}`;
                btn.classList.add('playing');
            }
        }

        function changeBpm(amount) {
            tempo += amount;
            if (tempo < 40) tempo = 40;
            if (tempo > 240) tempo = 240;
            updateUi();
        }

        function updateBpmFromSlider(val) {
            tempo = parseInt(val);
            updateUi();
        }

        function updateUi() {
            document.getElementById('bpmDisplay').innerText = tempo;
            document.getElementById('bpmSlider').value = tempo;
        }

        function createDots() {
            beatsPerMeasure = parseInt(document.getElementById('measureSelect').value);
            const container = document.getElementById('beatDots');
            container.innerHTML = '';
            for (let i = 0; i < beatsPerMeasure; i++) {
                const dot = document.createElement('div');
                dot.className = 'beat-dot';
                container.appendChild(dot);
            }
            if(isPlaying) {
                currentBeat = 0; 
            }
        }

        function updateVisuals(beat) {
            const dots = document.querySelectorAll('.beat-dot');
            dots.forEach(d => d.classList.remove('active'));
            if (dots[beat]) {
                dots[beat].classList.add('active');
            }
        }

        function resetVisuals() {
            document.querySelectorAll('.beat-dot').forEach(d => d.classList.remove('active'));
        }

        // --- AKORT Cƒ∞HAZI (TUNER) MANTIƒûI ---
        let tunerAudioCtx = null;
        let analyser = null;
        let rafID = null;
        let isTunerRunning = false;
        let mediaStreamSource = null;
        const tunerCanvas = document.getElementById('tunerGauge');
        const tunerCtx = tunerCanvas.getContext('2d');
        
        const noteStrings = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];

        function toggleTuner() {
            const btn = document.getElementById('tunerBtn');
            const status = document.getElementById('tunerStatus');

            if (isTunerRunning) {
                isTunerRunning = false;
                window.cancelAnimationFrame(rafID);
                if(tunerAudioCtx) tunerAudioCtx.suspend();
                if(mediaStreamSource) mediaStreamSource.disconnect();
                
                btn.innerHTML = `<i class="fas fa-microphone"></i> ${t("btn_tuner_start")}`;
                btn.classList.remove('tuner-btn-active');
                status.innerText = t("js_tuner_stopped");
                status.style.color = "#888";
                
                drawGauge(0, false); 
            } else {
                startTuner();
                btn.innerHTML = `<i class="fas fa-stop"></i> ${t("btn_tuner_stop")}`;
                btn.classList.add('tuner-btn-active');
                status.innerText = t("js_tuner_listening");
                status.style.color = "var(--yellow-portal)";
            }
        }

        async function startTuner() {
            if (!tunerAudioCtx) {
                tunerAudioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }
            await tunerAudioCtx.resume();

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                isTunerRunning = true;
                
                analyser = tunerAudioCtx.createAnalyser();
                analyser.fftSize = 2048;
                mediaStreamSource = tunerAudioCtx.createMediaStreamSource(stream);
                mediaStreamSource.connect(analyser);
                
                updatePitch();
            } catch (err) {
                console.error(err);
                alert(t("js_mic_error"));
                toggleTuner();
            }
        }

        function updatePitch() {
            if (!isTunerRunning) return;

            const bufferLength = analyser.fftSize;
            const buffer = new Float32Array(bufferLength);
            analyser.getFloatTimeDomainData(buffer);

            const frequency = autoCorrelate(buffer, tunerAudioCtx.sampleRate);

            if (frequency > -1) {
                const note = getNote(frequency);
                const cents = getCents(frequency, note);
                
                document.getElementById('noteName').innerText = noteStrings[note % 12];
                document.getElementById('noteOctave').innerText = Math.floor(note / 12) - 1;
                document.getElementById('frequencyValue').innerText = frequency.toFixed(1);
                
                drawGauge(cents, true);
            }

            rafID = window.requestAnimationFrame(updatePitch);
        }

        function autoCorrelate(buf, sampleRate) {
            let SIZE = buf.length;
            let rms = 0;
            for (let i = 0; i < SIZE; i++) {
                const val = buf[i];
                rms += val * val;
            }
            rms = Math.sqrt(rms / SIZE);
            if (rms < 0.01) return -1;

            let r1 = 0, r2 = SIZE - 1, thres = 0.2;
            for (let i = 0; i < SIZE / 2; i++) {
                if (Math.abs(buf[i]) < thres) { r1 = i; break; }
            }
            for (let i = 1; i < SIZE / 2; i++) {
                if (Math.abs(buf[SIZE - i]) < thres) { r2 = SIZE - i; break; }
            }

            buf = buf.slice(r1, r2);
            SIZE = buf.length;

            const c = new Array(SIZE).fill(0);
            for (let i = 0; i < SIZE; i++) {
                for (let j = 0; j < SIZE - i; j++) {
                    c[i] = c[i] + buf[j] * buf[j + i];
                }
            }

            let d = 0;
            while (c[d] > c[d + 1]) d++;
            let maxval = -1, maxpos = -1;
            for (let i = d; i < SIZE; i++) {
                if (c[i] > maxval) {
                    maxval = c[i];
                    maxpos = i;
                }
            }
            let T0 = maxpos;

            const x1 = c[T0 - 1], x2 = c[T0], x3 = c[T0 + 1];
            const a = (x1 + x3 - 2 * x2) / 2;
            const b = (x3 - x1) / 2;
            if (a) T0 = T0 - b / (2 * a);

            return sampleRate / T0;
        }

        function getNote(frequency) {
            const note = 12 * (Math.log(frequency / 440) / Math.log(2));
            return Math.round(note) + 69;
        }

        function getCents(frequency, note) {
            return Math.floor(1200 * Math.log(frequency / frequencyFromNoteNumber(note)) / Math.log(2));
        }

        function frequencyFromNoteNumber(note) {
            return 440 * Math.pow(2, (note - 69) / 12);
        }

        function drawGauge(cents, hasSignal) {
            const w = tunerCanvas.width;
            const h = tunerCanvas.height;
            const cx = w / 2;
            const cy = h - 40;
            const radius = 180;

            tunerCtx.clearRect(0, 0, w, h);

            tunerCtx.beginPath();
            tunerCtx.arc(cx, cy, radius, Math.PI, 2 * Math.PI);
            tunerCtx.lineWidth = 5;
            tunerCtx.strokeStyle = "rgba(255, 255, 255, 0.1)";
            tunerCtx.stroke();

            tunerCtx.beginPath();
            tunerCtx.arc(cx, cy, radius, 1.45 * Math.PI, 1.55 * Math.PI);
            tunerCtx.lineWidth = 10;
            tunerCtx.strokeStyle = "rgba(37, 211, 102, 0.5)"; 
            tunerCtx.stroke();

            for (let i = -50; i <= 50; i += 10) {
                const angle = map(i, -50, 50, Math.PI, 2 * Math.PI);
                const x1 = cx + Math.cos(angle) * (radius - 10);
                const y1 = cy + Math.sin(angle) * (radius - 10);
                const x2 = cx + Math.cos(angle) * radius;
                const y2 = cy + Math.sin(angle) * radius;
                
                tunerCtx.beginPath();
                tunerCtx.moveTo(x1, y1);
                tunerCtx.lineTo(x2, y2);
                tunerCtx.lineWidth = (i === 0) ? 3 : 1;
                tunerCtx.strokeStyle = (i === 0) ? "#ffd700" : "#666";
                tunerCtx.stroke();
            }

            let safeCents = Math.max(-50, Math.min(50, cents));
            
            if (!hasSignal) safeCents = -90; 

            const needleAngle = map(safeCents, -50, 50, Math.PI, 2 * Math.PI);
            
            let needleColor = "#c5a059"; 
            if (Math.abs(cents) < 5 && hasSignal) needleColor = "#25d366"; 
            else if (Math.abs(cents) > 20 && hasSignal) needleColor = "#ff4d4d"; 

            const nx = cx + Math.cos(needleAngle) * (radius - 20);
            const ny = cy + Math.sin(needleAngle) * (radius - 20);

            tunerCtx.beginPath();
            tunerCtx.moveTo(cx, cy);
            tunerCtx.lineTo(nx, ny);
            tunerCtx.lineWidth = 4;
            tunerCtx.strokeStyle = needleColor;
            tunerCtx.lineCap = "round";
            tunerCtx.stroke();

            tunerCtx.beginPath();
            tunerCtx.arc(cx, cy, 10, 0, 2 * Math.PI);
            tunerCtx.fillStyle = needleColor;
            tunerCtx.fill();
            
            tunerCtx.font = "14px Montserrat";
            tunerCtx.fillStyle = "#aaa";
            tunerCtx.textAlign = "center";
            tunerCtx.fillText("-50", cx - radius + 20, cy);
            tunerCtx.fillText("+50", cx + radius - 20, cy);
            tunerCtx.fillText("0", cx, cy - radius - 15);
        }

        function map(value, x1, y1, x2, y2) {
            return (value - x1) * (y2 - x2) / (y1 - x1) + x2;
        }

        document.addEventListener('DOMContentLoaded', () => {
            createDots(); 
            drawGauge(0, false); 
        });

    
    </script>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-auth.js";
  // Firestore (Veritabanƒ±) k√ºt√ºphaneleri
  import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.2.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBIx9TujKPX82NaWXGh2QTxyG6TEQ-abi8",
    authDomain: "baglamagram-portal.firebaseapp.com",
    projectId: "baglamagram-portal",
    storageBucket: "baglamagram-portal.firebasestorage.app",
    messagingSenderId: "498044667137",
    appId: "1:498044667137:web:e1a75ef1a0f0edf1330700",
    measurementId: "G-RD5H01SSTH"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  // ≈ûifre √á√∂z√ºc√º Fonksiyon
  function sifreCo(sifreliMetin) {
      try {
          return decodeURIComponent(escape(window.atob(sifreliMetin)));
      } catch (e) {
          console.error("≈ûifre √ß√∂zme hatasƒ±:", e);
          return sifreliMetin;
      }
  }

  // YENƒ∞ √ñƒûRENCƒ∞LERƒ∞N AD-SOYADINI ƒ∞LK BA≈ûTA BURAYA Gƒ∞RECEKSƒ∞N.
  const ogrenciListesi = {
      "Z29rYm95MDlAZ21haWwuY29t": { ad: "R29rMg==", soyad: "UEFJTlRFUg==" },
        "elifin-epostasƒ±-gelecek@xyz.com": { ad: "RWxpZg==", soyad: "S0FSTUFO" },
      "YnJrc2xudHNzQGdtYWlsLmNvbQ==": { ad: "TWFobXV0IEJ1cmFr", soyad: "QVNMQU5UQcWe" }
  };

  // --- ≈ûƒ∞FRE SIFIRLAMA FONKSƒ∞YONU EKLENDƒ∞ ---
  window.sifreSifirla = function() {
      const email = document.getElementById('emailInput').value;
      const status = document.getElementById('loginStatus');

      if (!email) {
          status.style.color = "orange";
          status.innerText = t("js_login_empty");
          return;
      }

      status.style.color = "yellow";
      status.innerText = t("js_reset_sending");

      sendPasswordResetEmail(auth, email)
        .then(() => {
            status.style.color = "#4CAF50"; // Ye≈üil
            status.innerText = t("js_reset_sent");
        })
        .catch((error) => {
            status.style.color = "#ff4d4d"; // Kƒ±rmƒ±zƒ±
            console.error(error);
            if (error.code === "auth/user-not-found") {
                status.innerText = t("js_user_not_found");
            } else if (error.code === "auth/invalid-email") {
                status.innerText = t("js_invalid_email");
            } else {
                status.innerText = t("js_error") + ": " + error.code;
            }
        });
  }

  // --- FOTOƒûRAF KAYDETME (VERƒ∞TABANINA) ---
  // Bu fonksiyonu window'a atƒ±yoruz ki HTML'den √ßaƒürƒ±labilsin
  window.saveProfilePhoto = function(input) {
    if (input.files && input.files[0]) {
        const file = input.files[0];
        const reader = new FileReader();
        
        reader.onload = function(e) {
            const img = new Image();
            img.onload = function() {
                // 1. Resmi K√º√ß√ºlt (Veritabanƒ±na sƒ±ƒümasƒ± i√ßin)
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                const MAX_SIZE = 300; 
                let width = img.width;
                let height = img.height;
                
                if (width > height) {
                    if (width > MAX_SIZE) { height *= MAX_SIZE / width; width = MAX_SIZE; }
                } else {
                    if (height > MAX_SIZE) { width *= MAX_SIZE / height; height = MAX_SIZE; }
                }
                canvas.width = width;
                canvas.height = height;
                ctx.drawImage(img, 0, 0, width, height);
                // Kaliteyi biraz daha d√º≈ü√ºrd√ºk (0.6) ki hƒ±zlƒ± olsun
                const dataUrl = canvas.toDataURL('image/jpeg', 0.6); 

                // 2. Ekrana bas (Kullanƒ±cƒ± anƒ±nda g√∂rs√ºn)
                document.getElementById('userAvatar').src = dataUrl;

                // 3. VERƒ∞TABANINA KAYDET
                const user = auth.currentUser;
                if (user) {
                    const userRef = doc(db, "kullanicilar", user.email);
                    setDoc(userRef, { profil_fotosu: dataUrl }, { merge: true })
                        .then(() => { console.log("Fotoƒüraf buluta kaydedildi!"); })
                        .catch((error) => { console.error("Yazma hatasƒ±:", error); });
                }
            };
            img.src = e.target.result;
        }
        reader.readAsDataURL(file);
    }
  }

  const loginBtn = document.getElementById('firebaseLoginBtn');
  const emailInput = document.getElementById('emailInput');
  const passInput = document.getElementById('passwordInput');
  
  function enterKontrol(e) {
      if (e.key === "Enter") loginBtn.click();
  }
  if(emailInput) emailInput.addEventListener("keyup", enterKontrol);
  if(passInput) passInput.addEventListener("keyup", enterKontrol);

  if(loginBtn) {
      loginBtn.addEventListener('click', () => {
          const email = emailInput.value;
          const pass = passInput.value;
          const status = document.getElementById('loginStatus');

          status.style.color = "yellow";
          status.innerText = t("js_check_info");

          signInWithEmailAndPassword(auth, email, pass)
            .then((userCredential) => {
                status.style.color = "#4CAF50"; 
                status.innerText = t("js_login_success");

                const girisYapanMail = userCredential.user.email;
                const sifreliMail = window.btoa(unescape(encodeURIComponent(girisYapanMail)));
                
                // Maili yine de hafƒ±zada tutalƒ±m (yedek olsun)
                localStorage.setItem('aktifKullaniciMail', girisYapanMail);

                setTimeout(() => {
                    document.getElementById("login-overlay").style.display = "none";
                    document.getElementById("portal-entry-btn-section").style.display = "none";
                    document.getElementById("public-content").style.display = "none";
                    document.getElementById("student-portal").style.display = "block";
                    document.body.classList.add("portal-active");

                    // ƒ∞Sƒ∞M AYARLAMA
                    let ogrenci = ogrenciListesi[sifreliMail];
                    if (ogrenci) {
                        const gercekAd = sifreCo(ogrenci.ad);
                        const gercekSoyad = sifreCo(ogrenci.soyad);
                        document.getElementById("displayAd").innerText = gercekAd;
                        document.getElementById("displaySoyad").innerText = gercekSoyad;
                        document.getElementById("welcomeTitle").innerText = t("js_welcome") + gercekAd + "!";
                    } else {
                        const varsayilanAd = girisYapanMail.split('@')[0];
                        document.getElementById("displayAd").innerText = varsayilanAd;
                        document.getElementById("displaySoyad").innerText = t("js_student");
                        document.getElementById("welcomeTitle").innerText = t("js_welcome") + "!";
                    }

                    // FOTOƒûRAFI VERƒ∞TABANINDAN √áEK
                    document.getElementById('userAvatar').src = "https://cdn-icons-png.flaticon.com/512/3135/3135715.png";
                    
                    const userRef = doc(db, "kullanicilar", girisYapanMail);
                    getDoc(userRef).then((docSnap) => {
                        if (docSnap.exists() && docSnap.data().profil_fotosu) {
                            document.getElementById('userAvatar').src = docSnap.data().profil_fotosu;
                        }
                    }).catch((error) => {
                        console.log("Fotoƒüraf √ßekilemedi (Hen√ºz y√ºklenmemi≈ü olabilir).");
                    });
                    
                    history.replaceState({view: 'dashboard-view'}, "", "#dashboard");
                }, 1500);
            })
            .catch((error) => {
                status.style.color = "#ff4d4d";
                console.error(error);
                if (error.code === "auth/invalid-credential") {
                    status.innerText = t("js_login_error");
                } else {
                    status.innerText = t("js_error");
                }
            });
      });
  }
</script>
   
</body>
</html>
